<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>デモ | イチメAI（日本語AIコーディング入門） | Winter Gator</title>
    <meta
      name="description"
      content="本体と同じUI/導線で体験できるダミーデモ（ブラウザ版）。"
    />
    <meta property="og:title" content="デモ | イチメAI（日本語AIコーディング入門） | Winter Gator" />
    <meta
      property="og:description"
      content="本体と同じUI/導線で体験できるダミーデモ（ブラウザ版）。"
    />
    <meta property="og:url" content="https://wintergator.com/demo/" />
    <meta property="og:site_name" content="Winter Gator" />
    <meta property="og:type" content="website" />
    <meta property="og:locale" content="ja_JP" />
    <meta property="og:image" content="https://wintergator.com/assets/og-default.png" />
    <meta property="og:image:secure_url" content="https://wintergator.com/assets/og-default.png" />
    <meta property="og:image:alt" content="イチメAI（日本語AIコーディング入門） | Winter Gator デモのOG画像" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@WinterGator_app" />
    <meta name="twitter:creator" content="@WinterGator_app" />
    <meta name="twitter:title" content="デモ | イチメAI（日本語AIコーディング入門） | Winter Gator" />
    <meta
      name="twitter:description"
      content="本体と同じUI/導線で体験できるダミーデモ（ブラウザ版）。"
    />
    <meta name="twitter:image" content="https://wintergator.com/assets/og-default.png" />
    <meta name="twitter:image:alt" content="イチメAI（日本語AIコーディング入門） | Winter Gator デモのOG画像" />
    <meta name="twitter:url" content="https://wintergator.com/demo/" />
    <meta name="robots" content="noindex" />
    <script src="/assets/site-config.js"></script>
    <script src="/site.js" defer></script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-QTPYX6S1D6"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-QTPYX6S1D6');
    </script>
    <style>
@import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500&family=Space+Grotesk:wght@400;500;600;700&display=swap');

:root {
  color-scheme: light;
  font-family: 'Space Grotesk', 'Helvetica Neue', Arial, sans-serif;
  line-height: 1.5;
  font-weight: 400;

  --text: #1f1b16;
  --muted: #5c554d;
  --accent: #e06b4f;
  --accent-strong: #c55239;
  --mint: #2f7a66;
  --danger: #b3261e;
  --card: rgba(255, 255, 255, 0.82);
  --border: rgba(20, 20, 20, 0.12);
  --shadow: 0 24px 48px rgba(26, 32, 44, 0.14);
  --radius: 20px;
}

* {
  box-sizing: border-box;
}

:root {
  --demo-disclaimer-height: 0px;
  --demo-cta-height: 0px;
}

.sr {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

body {
  margin: 0;
  min-height: 100vh;
  color: var(--text);
  background: #ffffff;
}

.app {
  position: relative;
  max-width: 980px;
  margin: 0 auto;
  padding: 48px 24px 80px;
}

.app.chat-app {
  --bg: #ffffff;
  --panel: #ffffff;
  --panel-2: #f3f4f6;
  --text: #111827;
  --muted: #6b7280;
  --border: rgba(17, 24, 39, 0.12);
  --shadow: 0 10px 30px rgba(17, 24, 39, 0.08);
  --accent: #e46a4f;
  --accent-weak: rgba(228, 106, 79, 0.12);
  --accent-2: #3b82f6;
  --ok: #16a34a;
  --warn: #d97706;
  --bad: #dc2626;
  --radius: 14px;
  --radius-lg: 18px;
  --radius-pill: 999px;
  --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono',
    'Courier New', monospace;
  --sans: ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, Helvetica, Arial,
    sans-serif;

  max-width: none;
  padding: 0;
  height: 100vh;
  display: grid;
  grid-template-columns: 300px minmax(0, 1fr);
  background: var(--bg);
  color: var(--text);
  font-family: var(--sans);
  overflow: hidden;
}

.app.chat-app::before {
  content: none;
}

.app.chat-app .sidebar {
  background: #fbfbfc;
  border-right: 1px solid var(--border);
  display: flex;
  flex-direction: column;
  min-width: 0;
  overflow: hidden;
}

.app.chat-app .sidebar-inner {
  display: flex;
  flex-direction: column;
  height: 100%;
}

.app.chat-app .sbTop {
  padding: 14px 14px 10px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
}

.app.chat-app .brand {
  display: flex;
  align-items: center;
  gap: 10px;
  min-width: 0;
}

.app.chat-app .logo {
  width: 34px;
  height: 34px;
  border-radius: 10px;
  background: var(--accent);
  color: #fff;
  display: grid;
  place-items: center;
  font-weight: 800;
  letter-spacing: 0.02em;
  flex: 0 0 auto;
}

.app.chat-app .brandText {
  min-width: 0;
}

.app.chat-app .brandText .name {
  font-size: 12px;
  letter-spacing: 0.14em;
  font-weight: 800;
  color: rgba(17, 24, 39, 0.75);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.app.chat-app .brandText .sub {
  margin-top: 2px;
  font-size: 12px;
  color: var(--muted);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.app.chat-app .sbBtns {
  padding: 0 14px 12px;
  display: flex;
  gap: 10px;
}

.app.chat-app .btn {
  appearance: none;
  border: 1px solid var(--border);
  background: #fff;
  border-radius: 12px;
  padding: 10px 12px;
  font-size: 13px;
  cursor: pointer;
  box-shadow: 0 1px 0 rgba(17, 24, 39, 0.03);
  transition: background 0.15s ease, transform 0.06s ease, border-color 0.15s ease;
  color: rgba(17, 24, 39, 0.9);
}

.app.chat-app .btn:hover {
  background: #fafafa;
}

.app.chat-app .btn:active {
  transform: translateY(1px);
}

.app.chat-app .btn.primary {
  background: var(--accent);
  border-color: rgba(228, 106, 79, 0.75);
  color: #fff;
}

.app.chat-app .btn.primary:hover {
  background: #dd5f44;
}

.app.chat-app .btn.ghost {
  background: transparent;
}

.app.chat-app .btn.icon {
  width: 40px;
  padding: 10px;
  display: grid;
  place-items: center;
  border-radius: 12px;
}

.app.chat-app .btn.small {
  padding: 8px 10px;
  font-size: 12px;
  border-radius: 10px;
}

.app.chat-app .sbSearch {
  padding: 0 14px 12px;
}

.app.chat-app .sbSearch input {
  width: 100%;
  padding: 11px 12px;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: #fff;
  outline: none;
  font-size: 13px;
}

.app.chat-app .sbSearch input:focus {
  border-color: rgba(228, 106, 79, 0.45);
  box-shadow: 0 0 0 4px rgba(228, 106, 79, 0.12);
}

.app.chat-app .sbSection {
  padding: 8px 14px 8px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  color: rgba(17, 24, 39, 0.86);
}

.app.chat-app .sbSection h3 {
  margin: 0;
  font-size: 12px;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  color: rgba(17, 24, 39, 0.6);
}

.app.chat-app .sbCount {
  font-size: 12px;
  color: var(--muted);
}

.app.chat-app .sessionList {
  padding: 0 8px 12px;
  overflow: auto;
}

.app.chat-app .sessionList.menu-open {
  overflow: visible;
}

.app.chat-app .session-empty {
  padding: 12px 10px;
  margin: 0 6px;
  font-size: 12px;
  color: var(--muted);
}

.app.chat-app .session {
  display: flex;
  gap: 12px;
  align-items: center;
  padding: 10px 12px;
  margin: 6px 6px;
  border-radius: 14px;
  cursor: pointer;
  border: 1px solid transparent;
  transition: background 0.15s ease, border-color 0.15s ease;
}

.app.chat-app .session:hover {
  background: rgba(17, 24, 39, 0.03);
}

.app.chat-app .session.active {
  background: rgba(228, 106, 79, 0.1);
  border-color: rgba(228, 106, 79, 0.2);
}

.app.chat-app .session .chip {
  flex: 0 0 auto;
  font-size: 11px;
  padding: 4px 8px;
  border-radius: var(--radius-pill);
  border: 1px solid var(--border);
  background: rgba(255, 255, 255, 0.85);
  color: rgba(17, 24, 39, 0.7);
  margin-top: 2px;
}

.app.chat-app .session .meta {
  display: flex;
  flex-direction: column;
  gap: 4px;
  min-width: 0;
  flex: 1 1 auto;
}

.app.chat-app .session .session-actions {
  position: relative;
  flex: 0 0 auto;
  min-width: 64px;
  display: flex;
  justify-content: flex-end;
  align-items: center;
  gap: 6px;
}

.app.chat-app .session .session-menu-button {
  width: 28px;
  height: 28px;
  border-radius: 8px;
  border: 1px solid transparent;
  background: transparent;
  color: rgba(17, 24, 39, 0.65);
  font-size: 18px;
  line-height: 1;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.15s ease, background 0.15s ease, border-color 0.15s ease;
}

.app.chat-app .session:hover .session-menu-button,
.app.chat-app .session.active .session-menu-button,
.app.chat-app .session:focus-within .session-menu-button,
.app.chat-app .session.menu-open .session-menu-button {
  opacity: 1;
  pointer-events: auto;
}

.app.chat-app .session .session-menu-button:hover {
  background: rgba(17, 24, 39, 0.08);
  border-color: rgba(17, 24, 39, 0.12);
}

.app.chat-app .session .session-action-btn {
  width: 28px;
  height: 28px;
  border-radius: 8px;
  border: 1px solid rgba(17, 24, 39, 0.12);
  background: rgba(255, 255, 255, 0.9);
  color: rgba(17, 24, 39, 0.8);
  font-size: 14px;
  line-height: 1;
  cursor: pointer;
  transition: background 0.15s ease, border-color 0.15s ease, color 0.15s ease;
}

.app.chat-app .session .session-action-btn:hover {
  background: rgba(17, 24, 39, 0.08);
  border-color: rgba(17, 24, 39, 0.2);
}

.app.chat-app .session .session-action-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.app.chat-app .session .session-menu-popover {
  position: absolute;
  top: 30px;
  right: 0;
  min-width: 150px;
  padding: 6px;
  border-radius: 10px;
  border: 1px solid rgba(17, 24, 39, 0.12);
  background: rgba(255, 255, 255, 0.98);
  box-shadow: 0 12px 26px rgba(15, 23, 42, 0.12);
  display: flex;
  flex-direction: column;
  gap: 4px;
  z-index: 20;
}

.app.chat-app .session .session-menu-item {
  text-align: left;
  padding: 6px 10px;
  border-radius: 8px;
  border: none;
  background: transparent;
  font-size: 12px;
  color: rgba(17, 24, 39, 0.8);
  cursor: pointer;
}

.app.chat-app .session .session-menu-item:hover {
  background: rgba(17, 24, 39, 0.08);
}

.app.chat-app .session .session-menu-item.danger {
  color: #b91c1c;
}

.app.chat-app .session .title {
  margin: 0;
  font-size: 14px;
  font-weight: 750;
  line-height: 1.2;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  min-width: 0;
}

.app.chat-app .session .meta-line {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 11px;
  color: var(--muted);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  min-width: 0;
}

.app.chat-app .session .meta-sep {
  color: rgba(148, 163, 184, 0.8);
}

.app.chat-app .session .time {
  font-size: 11px;
  color: inherit;
}

.app.chat-app .session-edit-input {
  font-size: 14px;
  padding: 6px 10px;
  width: 100%;
  line-height: 1.4;
  min-height: 32px;
  border-radius: 10px;
  min-width: 0;
}

.app.chat-app .sbBottom {
  margin-top: auto;
  padding: 12px 14px 14px;
  border-top: 1px solid var(--border);
  display: grid;
  gap: 10px;
}

.app.chat-app .sbUsage {
  border-radius: 14px;
  border: 1px solid rgba(15, 23, 42, 0.12);
  background: linear-gradient(180deg, rgba(15, 23, 42, 0.02), rgba(15, 23, 42, 0.06));
  padding: 12px 12px 10px;
  display: grid;
  gap: 8px;
}

.app.chat-app .sbUsageTop {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
}

.app.chat-app .sbUsageTitle {
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: rgba(148, 163, 184, 0.9);
}

.app.chat-app .sbUsagePlan {
  font-size: 12px;
  font-weight: 700;
  color: rgba(17, 24, 39, 0.88);
}

.app.chat-app .sbUsageRow {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 6px;
  font-size: 12px;
}

.app.chat-app .sbUsageLabel {
  color: rgba(100, 116, 139, 0.85);
}

.app.chat-app .sbUsageValue {
  font-weight: 600;
  color: rgba(17, 24, 39, 0.9);
}

.app.chat-app .sbUsageValue.is-unknown {
  color: rgba(148, 163, 184, 0.9);
}

.app.chat-app .sbUsageBar {
  height: 6px;
  border-radius: 999px;
  background: rgba(148, 163, 184, 0.2);
  overflow: hidden;
}

.app.chat-app .sbUsageBar.is-unknown {
  background: rgba(148, 163, 184, 0.12);
}

.app.chat-app .sbUsageFill {
  height: 100%;
  background: linear-gradient(90deg, rgba(59, 130, 246, 0.8), rgba(14, 165, 233, 0.85));
}

.app.chat-app .sbUsageBar.is-secondary .sbUsageFill {
  background: linear-gradient(90deg, rgba(234, 179, 8, 0.85), rgba(249, 115, 22, 0.85));
}

.app.chat-app .sbUsageNote {
  font-size: 11px;
  color: rgba(148, 163, 184, 0.9);
}

.app.chat-app .sbProjectMeta {
  padding: 0 14px 14px;
}

.app.chat-app .pill {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 8px 10px;
  border-radius: var(--radius-pill);
  border: 1px solid var(--border);
  background: #fff;
  font-size: 12px;
  color: rgba(17, 24, 39, 0.85);
  white-space: nowrap;
}

.app.chat-app .pill-button {
  cursor: pointer;
  font: inherit;
  transition: box-shadow 0.2s ease, transform 0.2s ease;
}

.app.chat-app .pill-button:hover {
  transform: translateY(-1px);
  box-shadow: 0 6px 12px rgba(31, 27, 22, 0.12);
}

.app.chat-app .pill-button:focus-visible {
  outline: 2px solid rgba(228, 106, 79, 0.35);
  outline-offset: 2px;
}

.app.chat-app .dot {
  width: 10px;
  height: 10px;
  border-radius: 999px;
  background: var(--ok);
  box-shadow: 0 0 0 3px rgba(22, 163, 74, 0.1);
}

.app.chat-app .dot-error {
  background: #dc2626;
  box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.15);
}

.app.chat-app .dot-warn {
  background: #f59e0b;
  box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.15);
}

.app .settings-btn {
  position: relative;
}

.app .settings-update-dot {
  position: absolute;
  top: 4px;
  right: 6px;
  width: 8px;
  height: 8px;
  border-radius: 999px;
  background: #f97316;
  box-shadow: 0 0 0 3px rgba(249, 115, 22, 0.15);
}

.app.chat-app .inline-spinner {
  width: 12px;
  height: 12px;
  border-radius: 999px;
  border: 2px solid rgba(17, 24, 39, 0.2);
  border-top-color: rgba(17, 24, 39, 0.6);
  display: inline-block;
  animation: spin 0.9s linear infinite;
}

.app.chat-app .main {
  min-width: 0;
  display: flex;
  flex-direction: column;
  min-height: 0;
  position: relative;
}

.app.chat-app .topbar {
  height: 56px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding: 10px 14px;
  background: var(--panel);
  border-bottom: 1px solid var(--border);
}

.app.chat-app .topLeft {
  display: flex;
  align-items: center;
  gap: 10px;
  min-width: 0;
}

.app.chat-app .hamburger {
  display: none;
}

.app.chat-app .crumb {
  display: flex;
  align-items: center;
  gap: 8px;
  min-width: 0;
}

.app.chat-app .crumb .project {
  font-weight: 800;
  font-size: 13px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 280px;
}

.app.chat-app .crumb .sep {
  color: rgba(17, 24, 39, 0.35);
}

.app.chat-app .crumb .sessionName {
  font-size: 13px;
  color: rgba(17, 24, 39, 0.75);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 360px;
}

.app.chat-app .modelMenu {
  position: relative;
}

.app.chat-app .modelBtn {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 12px;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: #fff;
  cursor: pointer;
  max-width: 320px;
}

.app.chat-app .modelBtn .label {
  min-width: 0;
  display: flex;
  flex-direction: column;
  line-height: 1.1;
}

.app.chat-app .modelBtn strong {
  font-size: 13px;
  font-weight: 850;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.app.chat-app .modelBtn span {
  font-size: 12px;
  color: var(--muted);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.app.chat-app .topRight {
  display: flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
  justify-content: flex-end;
}

.app.chat-app .status-chip {
  display: grid;
  gap: 2px;
  text-align: left;
  border: 1px solid var(--border);
  background: #fff;
  border-radius: 12px;
  padding: 6px 10px;
  cursor: pointer;
  max-width: 220px;
  font: inherit;
  color: var(--text);
  min-width: 0;
}

.app.chat-app .status-chip:hover {
  box-shadow: 0 8px 18px rgba(17, 24, 39, 0.12);
}

.app.chat-app .status-main,
.app.chat-app .status-sub {
  font-size: 0.72rem;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.app.chat-app .status-sub {
  color: var(--muted);
}

.app.chat-app .launchBlock {
  display: flex;
  align-items: center;
  gap: 6px;
  flex-wrap: wrap;
  justify-content: flex-end;
}

.app.chat-app .launchBlock .btn {
  white-space: nowrap;
}

.app.chat-app .launchNote {
  font-size: 11px;
  color: var(--muted);
  max-width: 200px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.app.chat-app .history-toast {
  position: absolute;
  top: 64px;
  right: 16px;
  z-index: 60;
  width: min(320px, 90vw);
  padding: 12px;
  border-radius: 14px;
  border: 1px solid rgba(0, 0, 0, 0.12);
  background: rgba(255, 255, 255, 0.96);
  box-shadow: 0 12px 20px rgba(31, 27, 22, 0.12);
  display: grid;
  gap: 10px;
}

.app.chat-app .history-toast-message {
  font-size: 13px;
  font-weight: 600;
  color: rgba(17, 24, 39, 0.9);
}

.app.chat-app .history-toast-actions {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  justify-content: flex-end;
}

.app.chat-app .ui-template-notice {
  margin: 12px 16px 0;
  padding: 12px 14px;
  border-radius: 14px;
  border: 1px solid rgba(224, 107, 79, 0.35);
  background: rgba(255, 243, 238, 0.9);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  color: rgba(66, 20, 7, 0.9);
  font-size: 0.9rem;
}

.app.chat-app .chat {
  flex: 1 1 auto;
  min-height: 0;
  display: flex;
  flex-direction: column;
  background: var(--panel);
}

.app.chat-app .messages {
  flex: 1 1 auto;
  min-height: 0;
  overflow: auto;
  padding: 18px 16px 14px;
  overscroll-behavior: contain;
  -webkit-overflow-scrolling: touch;
}

.app.chat-app .centerCol {
  max-width: 860px;
  margin: 0 auto;
}

.app.chat-app .day {
  text-align: center;
  font-size: 12px;
  color: var(--muted);
  margin: 10px 0 18px;
}

.app.chat-app .msg {
  display: flex;
  gap: 12px;
  margin: 12px 0;
  align-items: flex-start;
}

.app.chat-app .msg.user {
  justify-content: flex-end;
}

.app.chat-app .msg.assistant {
  justify-content: flex-start;
}

.app.chat-app .avatar {
  width: 30px;
  height: 30px;
  border-radius: 10px;
  background: rgba(17, 24, 39, 0.06);
  display: grid;
  place-items: center;
  font-size: 12px;
  font-weight: 800;
  color: rgba(17, 24, 39, 0.65);
  flex: 0 0 auto;
}

.app.chat-app .avatar.user {
  background: rgba(228, 106, 79, 0.12);
  color: rgba(228, 106, 79, 0.95);
}

.app.chat-app .bubble {
  max-width: min(740px, 86%);
  padding: 12px 14px;
  border-radius: 16px;
  border: 1px solid var(--border);
  background: #fff;
  line-height: 1.6;
  font-size: 14px;
  white-space: pre-wrap;
  word-break: break-word;
  box-shadow: 0 1px 0 rgba(17, 24, 39, 0.03);
}

.app.chat-app .msg.user .bubble {
  background: var(--accent-weak);
  border-color: rgba(228, 106, 79, 0.2);
}

.app.chat-app .meta {
  margin-top: 8px;
  font-size: 12px;
  color: var(--muted);
  display: flex;
  align-items: center;
  gap: 8px;
}

.app.chat-app .planner-recommend-actions {
  margin-top: 10px;
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  flex-wrap: wrap;
}

.app.chat-app .planner-recommend-actions.plannerQuick {
  margin: 10px 0 0;
  justify-content: flex-end;
}

.app.chat-app .planner-recommend-guard {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 4px;
}

.app.chat-app .planner-recommend-hint {
  color: var(--muted);
}

.app.chat-app .attachmentList {
  display: grid;
  gap: 8px;
  margin-top: 10px;
}

.app.chat-app .attachmentItem {
  display: flex;
  gap: 10px;
  align-items: center;
  padding: 8px;
  border-radius: 12px;
  background: rgba(17, 24, 39, 0.04);
}

.app.chat-app .attachmentPreview {
  width: 64px;
  height: 64px;
  border-radius: 10px;
  object-fit: cover;
  border: 1px solid var(--border);
}

.app.chat-app .attachmentBadge {
  width: 64px;
  height: 64px;
  border-radius: 10px;
  display: grid;
  place-items: center;
  background: rgba(17, 24, 39, 0.08);
  font-size: 20px;
}

.app.chat-app .attachmentInfo {
  min-width: 0;
}

.app.chat-app .attachmentPath {
  font-size: 12px;
  color: var(--muted);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.app.chat-app .composer {
  border-top: 1px solid var(--border);
  background: linear-gradient(180deg, rgba(255, 255, 255, 0.85), rgba(255, 255, 255, 0.92));
  padding: 12px 14px 14px;
}

.app.chat-app .attachmentQueue {
  display: grid;
  gap: 10px;
  margin-bottom: 10px;
}

.app.chat-app .attachmentSummary {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  font-size: 12px;
  color: var(--muted);
}

.app.chat-app .attachmentSummaryItem {
  display: inline-flex;
  align-items: center;
}

.app.chat-app .attachmentChip {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 8px 10px;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: rgba(255, 255, 255, 0.9);
}

.app.chat-app .attachmentThumb {
  width: 40px;
  height: 40px;
  border-radius: 8px;
  object-fit: cover;
  border: 1px solid var(--border);
}

.app.chat-app .attachmentIcon {
  width: 40px;
  height: 40px;
  border-radius: 8px;
  display: grid;
  place-items: center;
  background: rgba(17, 24, 39, 0.06);
  font-size: 18px;
}

.app.chat-app .attachmentMeta {
  flex: 1 1 auto;
  min-width: 0;
}

.app.chat-app .attachmentName {
  font-size: 13px;
  font-weight: 700;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.app.chat-app .attachmentSize {
  font-size: 12px;
  color: var(--muted);
}

.app.chat-app .attachmentRemove {
  border: none;
  background: transparent;
  font-size: 16px;
  cursor: pointer;
  color: var(--muted);
}

.app.chat-app .attachmentHint {
  margin: 0 0 8px;
}

.app.chat-app .plannerQuick {
  max-width: 860px;
  margin: 0 auto 8px;
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.app.chat-app .plannerQuick .btn {
  white-space: nowrap;
}

.app.chat-app .composerQuick {
  max-width: 860px;
  margin: 0 auto 8px;
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.app.chat-app .composerQuick .btn {
  white-space: nowrap;
}

.app.chat-app .fileInput {
  display: none;
}

.app.chat-app .composerInner {
  max-width: 860px;
  margin: 0 auto;
  display: flex;
  gap: 10px;
  align-items: flex-end;
}

.app.chat-app .composer textarea {
  flex: 1 1 auto;
  resize: none;
  min-height: 50px;
  max-height: 170px;
  padding: 12px 12px;
  border-radius: 16px;
  border: 1px solid var(--border);
  background: #fff;
  outline: none;
  font-size: 0.95rem;
  line-height: 1.45;
  font-family: inherit;
}

.app.chat-app .composer textarea:focus {
  border-color: rgba(228, 106, 79, 0.45);
  box-shadow: 0 0 0 4px rgba(228, 106, 79, 0.1);
}

.app.chat-app .composerActions {
  display: flex;
  gap: 8px;
  align-items: center;
}

.app.chat-app .attachmentCounter {
  font-size: 12px;
  color: var(--muted);
  white-space: nowrap;
}

.app.chat-app .attachmentPickInfo {
  margin: 0 0 6px;
  color: var(--muted);
}

.app.chat-app .hint {
  max-width: 860px;
  margin: 8px auto 0;
  display: flex;
  justify-content: space-between;
  gap: 10px;
  flex-wrap: wrap;
  font-size: 12px;
  color: var(--muted);
}

.app.chat-app .kbd {
  font-family: var(--mono);
  font-size: 11px;
  padding: 2px 6px;
  border-radius: 8px;
  border: 1px solid var(--border);
  background: #fff;
  color: rgba(17, 24, 39, 0.75);
}

.app.chat-app .popover {
  position: fixed;
  top: 64px;
  left: 330px;
  width: min(420px, calc(100vw - 24px));
  max-height: min(70vh, 520px);
  border-radius: var(--radius-lg);
  border: 1px solid var(--border);
  background: #fff;
  box-shadow: var(--shadow);
  display: none;
  overflow: auto;
  z-index: 50;
}

.app.chat-app .popover.open {
  display: block;
}

.app.chat-app .popHead {
  padding: 12px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-bottom: 1px solid var(--border);
  gap: 10px;
}

.app.chat-app .popActions {
  display: flex;
  align-items: center;
  gap: 8px;
}

.app.chat-app .popHead strong {
  font-size: 13px;
}

.app.chat-app .popBody {
  padding: 10px;
}

.app.chat-app .popLabel {
  font-size: 12px;
  color: var(--muted);
  margin-bottom: 8px;
}

.app.chat-app .popLabel.tip {
  color: #2563eb;
  font-weight: 600;
  cursor: help;
}

.app.chat-app .popSection {
  display: grid;
  gap: 8px;
  margin-bottom: 10px;
}

.app.chat-app .popRecommend {
  display: grid;
  gap: 8px;
}

.app.chat-app .popAdvanced {
  margin-top: 6px;
  border-top: 1px dashed rgba(17, 24, 39, 0.12);
  padding-top: 8px;
}

.app.chat-app .popAdvanced summary {
  cursor: pointer;
  list-style: none;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 8px 10px;
  border-radius: 12px;
  background: rgba(17, 24, 39, 0.04);
  font-size: 12px;
  font-weight: 700;
  color: rgba(17, 24, 39, 0.8);
}

.app.chat-app .popAdvanced summary::-webkit-details-marker {
  display: none;
}

.app.chat-app .popAdvanced summary .caret {
  transition: transform 0.2s ease;
}

.app.chat-app .popAdvanced[open] summary .caret {
  transform: rotate(180deg);
}

.app.chat-app .popAdvancedBody {
  margin-top: 8px;
  display: grid;
  gap: 8px;
}

.app.chat-app .opt {
  padding: 10px;
  border-radius: 14px;
  border: 1px solid transparent;
  cursor: pointer;
  display: flex;
  gap: 10px;
  align-items: flex-start;
  background: transparent;
  width: 100%;
}

.app.chat-app .opt:focus-visible {
  outline: 2px solid rgba(228, 106, 79, 0.35);
  outline-offset: 2px;
}

.app.chat-app .opt.rec {
  border-color: rgba(17, 24, 39, 0.12);
  background: rgba(17, 24, 39, 0.02);
}

.app.chat-app .opt:hover {
  background: rgba(17, 24, 39, 0.03);
}

.app.chat-app .opt.current {
  cursor: default;
  background: rgba(17, 24, 39, 0.02);
}

.app.chat-app .opt.rec.disabled {
  cursor: not-allowed;
  opacity: 0.65;
}

.app.chat-app .opt.active {
  border-color: rgba(228, 106, 79, 0.25);
  background: rgba(228, 106, 79, 0.08);
}

.app.chat-app .opt .t {
  font-weight: 850;
  font-size: 13px;
}

.app.chat-app .optBadge {
  display: inline-flex;
  align-items: center;
  padding: 2px 6px;
  border-radius: 999px;
  font-size: 10px;
  font-weight: 700;
  margin-left: 6px;
  background: rgba(228, 106, 79, 0.15);
  color: rgba(120, 48, 32, 0.9);
}

.app.chat-app .opt .modelId {
  font-size: 11px;
  color: var(--muted);
  margin-top: 2px;
}

.app.chat-app .opt .d {
  font-size: 12px;
  color: var(--muted);
  margin-top: 2px;
}

.app.chat-app .opt .note {
  font-size: 11px;
  color: rgba(17, 24, 39, 0.6);
  margin-top: 4px;
}

.app.chat-app .divider {
  height: 1px;
  background: rgba(17, 24, 39, 0.1);
  margin: 10px 0;
}

.app.chat-app .seg {
  display: flex;
  gap: 8px;
}

.app.chat-app .seg button {
  flex: 1 1 auto;
  padding: 10px;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: #fff;
  cursor: pointer;
  font-size: 12px;
  color: rgba(17, 24, 39, 0.82);
  text-align: left;
}

.app.chat-app .seg button.active {
  border-color: rgba(228, 106, 79, 0.35);
  background: rgba(228, 106, 79, 0.1);
  font-weight: 800;
}

.app.chat-app .segTitle {
  display: inline-flex;
  align-items: center;
  gap: 6px;
}

.app.chat-app .segBadge {
  display: inline-flex;
  align-items: center;
  padding: 2px 6px;
  border-radius: 999px;
  font-size: 10px;
  font-weight: 700;
  line-height: 1;
  white-space: nowrap;
  background: rgba(37, 99, 235, 0.12);
  color: rgba(30, 64, 175, 0.95);
}

.app.chat-app .seg small {
  display: block;
  color: var(--muted);
  margin-top: 2px;
  font-weight: 500;
}

.app.chat-app .popNote {
  font-size: 12px;
  color: var(--muted);
  line-height: 1.5;
}

.app.chat-app .overlay {
  position: fixed;
  inset: 0;
  background: rgba(17, 24, 39, 0.45);
  display: none;
  z-index: 80;
}

.app.chat-app .overlay.open {
  display: block;
}

.app .detail-overlay {
  position: fixed;
  inset: 0;
  background: rgba(17, 24, 39, 0.45);
  display: none;
  z-index: 90;
}

.app .detail-overlay.open {
  display: block;
}

.app.chat-app .drawer {
  position: fixed;
  top: 0;
  bottom: 0;
  left: 0;
  width: min(86vw, 320px);
  background: #fbfbfc;
  border-right: 1px solid var(--border);
  box-shadow: var(--shadow);
  transform: translateX(-102%);
  transition: transform 0.22s ease;
  z-index: 90;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.app.chat-app .drawer .sbTop {
  border-bottom: 1px solid var(--border);
}

.app.chat-app .drawer.open {
  transform: translateX(0);
}

.app .detail-drawer {
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  width: min(420px, 95vw);
  background: rgba(255, 255, 255, 0.98);
  border-left: 1px solid var(--border);
  box-shadow: var(--shadow);
  transform: translateX(102%);
  transition: transform 0.22s ease;
  z-index: 95;
  visibility: hidden;
  pointer-events: none;
}

.app .detail-drawer.open {
  transform: translateX(0);
  visibility: visible;
  pointer-events: auto;
}

.app .detail-inner {
  height: 100%;
  overflow-y: auto;
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.app .detail-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
}

.app .mode-switch {
  display: flex;
  gap: 8px;
}

.app.chat-app .chat-empty {
  padding: 24px;
  border-radius: 16px;
  border: 1px dashed rgba(228, 106, 79, 0.3);
  background: rgba(228, 106, 79, 0.06);
  text-align: center;
}

.app.chat-app .chat-empty-start {
  min-height: 60vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 16px;
  padding: 24px;
  text-align: center;
}

.app.chat-app .chat-empty-start .modePicker {
  width: 100%;
}

.app.chat-app .startLead {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.app.chat-app .startTitle {
  font-size: 1.1rem;
  font-weight: 900;
}

.app.chat-app .startSub {
  font-size: 0.9rem;
  color: var(--muted);
}

.app.chat-app .modePicker {
  border-radius: var(--radius-lg);
  border: 1px solid rgba(17, 24, 39, 0.12);
  background: #fff;
  box-shadow: var(--shadow);
  overflow: hidden;
  max-width: min(820px, 96%);
}

.app.chat-app .modeHead {
  padding: 14px 14px 12px;
  border-bottom: 1px solid rgba(17, 24, 39, 0.1);
  background: linear-gradient(180deg, rgba(228, 106, 79, 0.06), rgba(255, 255, 255, 1));
}

.app.chat-app .modeHead .title {
  font-weight: 950;
  font-size: 14px;
}

.app.chat-app .modeHead .sub {
  margin-top: 6px;
  font-size: 12px;
  color: var(--muted);
  line-height: 1.45;
}

.app.chat-app .modeBody {
  padding: 12px 12px 14px;
}

.app.chat-app .modeGrid {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 10px;
}

.app.chat-app .modeBtn {
  width: 100%;
  text-align: left;
  border-radius: 16px;
  padding: 12px 12px;
  border: 1px solid rgba(17, 24, 39, 0.12);
  background: rgba(17, 24, 39, 0.02);
  cursor: pointer;
  transition: transform 0.06s ease, background 0.15s ease, border-color 0.15s ease;
  display: flex;
  flex-direction: column;
  gap: 8px;
  min-height: 140px;
}

.app.chat-app .modeBtn:hover {
  background: rgba(17, 24, 39, 0.03);
}

.app.chat-app .modeBtn:active {
  transform: translateY(1px);
}

.app.chat-app .modeBtn .top {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: 10px;
}

.app.chat-app .modeBtn .name {
  font-weight: 950;
  font-size: 14px;
}

.app.chat-app .modeBtn .desc {
  font-size: 12px;
  color: var(--muted);
  line-height: 1.45;
  white-space: pre-wrap;
}

.app.chat-app .modeBtn .tag {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 4px 8px;
  border-radius: var(--radius-pill);
  border: 1px solid rgba(17, 24, 39, 0.12);
  background: #fff;
  font-size: 11px;
  color: rgba(17, 24, 39, 0.75);
  white-space: nowrap;
}

.app.chat-app .modeBtn .tag.rec {
  border-color: rgba(59, 130, 246, 0.25);
  background: rgba(59, 130, 246, 0.08);
  color: rgba(17, 24, 39, 0.88);
  font-weight: 800;
}

.app.chat-app .modeBtn .tag.lock {
  border-color: rgba(220, 38, 38, 0.18);
  background: rgba(220, 38, 38, 0.06);
  color: rgba(220, 38, 38, 0.85);
  font-weight: 850;
}

.app.chat-app .modeBtn.disabled {
  cursor: not-allowed;
  opacity: 0.62;
  background: rgba(17, 24, 39, 0.015);
}

.app.chat-app .modeBtn.disabled:hover {
  background: rgba(17, 24, 39, 0.015);
}

.app.chat-app .modeBtn .actions {
  margin-top: auto;
  display: flex;
  gap: 8px;
  align-items: center;
  flex-wrap: wrap;
  font-size: 12px;
  color: rgba(17, 24, 39, 0.55);
}

.app.chat-app .modeBtn .mini {
  border: 1px solid rgba(17, 24, 39, 0.12);
  background: #fff;
  border-radius: 12px;
  padding: 8px 10px;
  font-size: 12px;
  cursor: pointer;
}

.app.chat-app .modeBtn .mini.primary {
  border-color: rgba(228, 106, 79, 0.3);
  background: rgba(228, 106, 79, 0.1);
  font-weight: 850;
}

.app.chat-app .modeBtn .mini:active {
  transform: translateY(1px);
}

.app.chat-app .modeFoot {
  padding: 10px 12px 12px;
  border-top: 1px solid rgba(17, 24, 39, 0.1);
  display: flex;
  justify-content: space-between;
  gap: 10px;
  flex-wrap: wrap;
  font-size: 12px;
  color: var(--muted);
}

.app.chat-app .modeFoot .link {
  color: rgba(59, 130, 246, 0.95);
  cursor: pointer;
  text-decoration: underline;
  text-underline-offset: 3px;
  background: transparent;
  border: none;
  padding: 0;
  font: inherit;
}

@media (max-width: 980px) {
  .app.chat-app {
    grid-template-columns: 1fr;
  }

  .app.chat-app .sidebar {
    display: none;
  }

  .app.chat-app .hamburger {
    display: inline-grid;
  }

  .app.chat-app .popover {
    left: 12px;
    right: 12px;
    width: auto;
  }

  .app.chat-app .crumb .project {
    max-width: 200px;
  }

  .app.chat-app .crumb .sessionName {
    max-width: 200px;
  }

  .app.chat-app .modeGrid {
    grid-template-columns: 1fr;
  }
}

.app::before {
  content: '';
  position: absolute;
  inset: -120px 0 auto 0;
  height: 360px;
  background: radial-gradient(closest-side at 30% 60%, rgba(255, 255, 255, 0.5), transparent 70%);
  pointer-events: none;
  opacity: 0.7;
}

.hero {
  display: flex;
  align-items: flex-end;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: 16px;
  margin-bottom: 32px;
}

.eyebrow {
  margin: 0 0 8px;
  text-transform: uppercase;
  letter-spacing: 0.2em;
  font-size: 0.75rem;
  color: var(--muted);
}

h1 {
  margin: 0 0 12px;
  font-size: clamp(2rem, 3vw, 2.8rem);
  font-weight: 700;
}

.subtitle {
  margin: 0;
  max-width: 480px;
  color: var(--muted);
}

.hero-links {
  margin-top: 16px;
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
}

.chat-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: 16px;
  margin-bottom: 16px;
}

.chat-header-left,
.chat-header-center,
.chat-header-right {
  display: flex;
  align-items: center;
  gap: 12px;
  flex-wrap: wrap;
}

.brand {
  font-weight: 700;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  font-size: 0.75rem;
  color: var(--muted);
}

.brand-mark {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  border-radius: 10px;
  background: var(--accent);
  color: #fff;
  font-size: 0.65rem;
  font-weight: 700;
  letter-spacing: 0.2em;
  box-shadow: 0 10px 18px rgba(224, 107, 79, 0.3);
}

.project-chip,
.model-chip {
  border: 1px solid rgba(0, 0, 0, 0.12);
  background: rgba(255, 255, 255, 0.8);
  color: var(--text);
  border-radius: 999px;
  padding: 8px 16px;
  font-size: 0.85rem;
  font-weight: 600;
  cursor: pointer;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.project-chip:hover,
.model-chip:hover {
  transform: translateY(-1px);
  box-shadow: 0 10px 18px rgba(31, 27, 22, 0.12);
}

.model-menu {
  position: relative;
}

.model-menu-popover {
  position: absolute;
  top: calc(100% + 10px);
  right: 0;
  width: min(340px, 90vw);
  padding: 16px;
  border-radius: 18px;
  border: 1px solid rgba(0, 0, 0, 0.12);
  background: rgba(255, 255, 255, 0.96);
  box-shadow: var(--shadow);
  display: grid;
  gap: 16px;
  z-index: 20;
}

.model-menu-section {
  display: grid;
  gap: 8px;
}

.model-menu-options {
  display: grid;
  gap: 8px;
}

.model-option {
  text-align: left;
  border-radius: 14px;
  border: 1px solid rgba(0, 0, 0, 0.12);
  padding: 10px 12px;
  background: rgba(255, 255, 255, 0.7);
  font-weight: 600;
  color: var(--text);
  display: grid;
  gap: 4px;
  cursor: pointer;
  transition: border 0.2s ease, box-shadow 0.2s ease, transform 0.2s ease;
}

.model-option:hover {
  transform: translateY(-1px);
  box-shadow: 0 12px 18px rgba(31, 27, 22, 0.12);
}

.model-option.is-active {
  border-color: rgba(224, 107, 79, 0.6);
  box-shadow: 0 12px 20px rgba(224, 107, 79, 0.18);
}

.model-option-title {
  font-size: 0.9rem;
}

.model-option-desc {
  font-size: 0.75rem;
  color: var(--muted);
  font-weight: 500;
}

.model-menu-footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
}

.chat-shell {
  display: grid;
  grid-template-columns: minmax(240px, 300px) minmax(0, 1fr);
  gap: 16px;
  align-items: start;
}

.chat-shell.right-open {
  grid-template-columns: minmax(240px, 300px) minmax(0, 1fr) minmax(280px, 380px);
}

.chat-sidebar,
.chat-detail {
  position: sticky;
  top: 16px;
  max-height: calc(100vh - 120px);
  overflow-y: auto;
  padding-bottom: 16px;
}

.chat-detail {
  display: none;
}

.chat-shell.right-open .chat-detail {
  display: block;
}

.chat-center {
  display: flex;
  flex-direction: column;
  min-height: calc(100vh - 160px);
  gap: 12px;
}

.chat-center-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: 12px;
}

.chat-timeline {
  flex: 1;
  min-height: 320px;
  min-height: 0;
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.chat-thread {
  flex: 1;
  min-height: 0;
  display: flex;
  flex-direction: column;
  gap: 16px;
  overflow-y: auto;
  padding: 4px 6px 24px;
  scroll-behavior: smooth;
}

.chat-message {
  display: flex;
  flex-direction: column;
  gap: 6px;
  max-width: min(720px, 100%);
}

.chat-message.user {
  align-self: flex-end;
  text-align: right;
}

.chat-message.assistant {
  align-self: flex-start;
}

.chat-message-meta {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 0.7rem;
  text-transform: uppercase;
  letter-spacing: 0.12em;
  color: var(--muted);
}

.chat-message-role {
  font-weight: 600;
}

.chat-message-time {
  font-variant-numeric: tabular-nums;
}

.chat-bubble {
  border-radius: 16px;
  border: 1px solid rgba(0, 0, 0, 0.12);
  padding: 12px 16px;
  background: rgba(255, 255, 255, 0.9);
  box-shadow: 0 12px 24px rgba(31, 27, 22, 0.1);
}

.chat-bubble.user {
  background: rgba(224, 107, 79, 0.12);
  border-color: rgba(224, 107, 79, 0.35);
}

.chat-bubble.assistant {
  background: rgba(255, 255, 255, 0.86);
}

.chat-bubble pre {
  margin: 0;
  white-space: pre-wrap;
  font-family: 'IBM Plex Mono', 'SFMono-Regular', Consolas, 'Liberation Mono', monospace;
  font-size: 0.9rem;
  line-height: 1.6;
}

.chat-empty {
  padding: 24px;
  border-radius: 16px;
  border: 1px dashed rgba(0, 0, 0, 0.16);
  text-align: center;
  color: var(--muted);
}

.chat-scroll-bottom {
  align-self: center;
}

.chat-debug {
  border-radius: 16px;
  border: 1px solid rgba(0, 0, 0, 0.12);
  background: rgba(255, 255, 255, 0.7);
  padding: 8px 12px;
}

.chat-debug summary {
  cursor: pointer;
  font-weight: 600;
  list-style: none;
}

.chat-debug summary::-webkit-details-marker {
  display: none;
}

.chat-input {
  position: sticky;
  bottom: 16px;
  background: rgba(255, 255, 255, 0.85);
  border-radius: 18px;
  padding: 16px;
  border: 1px solid rgba(0, 0, 0, 0.12);
  box-shadow: 0 16px 30px rgba(31, 27, 22, 0.18);
  backdrop-filter: blur(10px);
}

.chat-input-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: 8px;
  margin-bottom: 8px;
}

.session-sidebar {
  display: grid;
  gap: 12px;
}

.session-sidebar-header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: 12px;
}

.session-project-name {
  margin: 4px 0 0;
  font-weight: 600;
}

.session-sidebar-actions {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  justify-content: flex-end;
}

.session-sidebar-list {
  display: grid;
  gap: 12px;
}

.session-sidebar-item {
  border-radius: 16px;
  border: 1px solid rgba(0, 0, 0, 0.12);
  background: rgba(255, 255, 255, 0.7);
  padding: 12px;
  display: grid;
  gap: 8px;
}

.session-sidebar-item.is-active {
  border-color: rgba(224, 107, 79, 0.7);
  box-shadow: 0 12px 20px rgba(224, 107, 79, 0.16);
}

.session-sidebar-button {
  text-align: left;
  background: none;
  border: none;
  padding: 0;
  display: grid;
  gap: 4px;
  cursor: pointer;
}

.session-sidebar-title {
  font-weight: 600;
}

.session-sidebar-meta {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  flex-wrap: wrap;
}

.session-sidebar-input {
  width: 100%;
}

.session-sidebar-empty {
  padding: 12px;
  border-radius: 12px;
  border: 1px dashed rgba(0, 0, 0, 0.2);
  color: var(--muted);
}

.start-flow-hero .subtitle {
  max-width: 520px;
}

.start-flow-toolbar,
.start-flow-actions {
  display: flex;
  align-items: center;
  flex-wrap: wrap;
  gap: 12px;
}

.start-flow-menu {
  position: relative;
}

.start-flow-menu .btn {
  min-width: auto;
  padding-left: 14px;
  padding-right: 14px;
}

.start-flow-menu-panel {
  position: absolute;
  right: 0;
  top: calc(100% + 6px);
  min-width: 160px;
  background: rgba(255, 255, 255, 0.98);
  border: 1px solid rgba(0, 0, 0, 0.08);
  border-radius: 12px;
  padding: 8px;
  box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
  display: grid;
  gap: 6px;
  z-index: 3;
}

.start-flow-menu-item {
  width: 100%;
  border: none;
  background: transparent;
  border-radius: 10px;
  padding: 8px 10px;
  text-align: left;
  cursor: pointer;
  font-size: 0.9rem;
  font-weight: 600;
  color: var(--ink);
}

.start-flow-menu-item:hover {
  background: rgba(224, 107, 79, 0.12);
}

.start-flow-card {
  display: grid;
  gap: 16px;
}

.start-flow-boot {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 120px;
}

.start-flow-header {
  display: grid;
  gap: 6px;
  margin-bottom: 8px;
}

.start-flow-kicker {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: fit-content;
  padding: 4px 10px;
  border-radius: 999px;
  font-size: 0.75rem;
  font-weight: 700;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  background: rgba(37, 99, 235, 0.12);
  color: #1d4ed8;
}

.start-flow-title {
  margin: 0;
  font-size: 1rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
}

.start-flow-text {
  margin: 0;
  color: var(--muted);
}

.start-flow-status {
  align-items: center;
}

.start-flow-login {
  display: grid;
  gap: 12px;
}

.start-flow-primary {
  align-self: flex-start;
  min-width: 200px;
}

.start-flow-recommend {
  display: grid;
  gap: 8px;
  align-items: start;
}

.start-flow-options {
  display: grid;
  gap: 16px;
}

.start-flow-option {
  border-radius: 16px;
  border: 1px solid rgba(0, 0, 0, 0.08);
  background: rgba(255, 255, 255, 0.7);
  padding: 14px;
}

.start-flow-option summary {
  cursor: pointer;
  font-weight: 600;
  letter-spacing: 0.04em;
  list-style: none;
}

.start-flow-option summary::-webkit-details-marker {
  display: none;
}

.start-flow-option[open] summary {
  margin-bottom: 12px;
}

.start-flow-details {
  border-radius: 16px;
  border: 1px solid rgba(0, 0, 0, 0.08);
  background: rgba(255, 255, 255, 0.7);
  padding: 14px;
}

.start-flow-details summary {
  cursor: pointer;
  font-weight: 600;
  letter-spacing: 0.02em;
  list-style: none;
}

.start-flow-details summary::-webkit-details-marker {
  display: none;
}

.start-flow-details[open] summary {
  margin-bottom: 12px;
}

.start-flow-alert {
  margin: 12px 0 16px;
  padding: 14px 16px;
  border-radius: 14px;
  border: 1px solid rgba(220, 38, 38, 0.2);
  background: linear-gradient(180deg, rgba(248, 113, 113, 0.16), rgba(248, 113, 113, 0.05));
  color: #7f1d1d;
  box-shadow: 0 10px 24px -22px rgba(127, 29, 29, 0.8);
}

.start-flow-alert-title {
  font-weight: 700;
  font-size: 0.95rem;
  margin-bottom: 6px;
}

.start-flow-alert-body {
  margin: 0 0 8px;
  font-size: 0.9rem;
  line-height: 1.6;
  white-space: pre-wrap;
}

.start-flow-details-body {
  display: grid;
  gap: 16px;
}

.start-flow-block {
  display: grid;
  gap: 12px;
}

.field-label {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  width: fit-content;
  padding: 4px 10px;
  border-radius: 999px;
  font-size: 0.85rem;
  font-weight: 700;
  color: rgba(15, 23, 42, 0.88);
  background: rgba(15, 23, 42, 0.06);
}

.field-required {
  display: inline-flex;
  align-items: center;
  padding: 2px 6px;
  border-radius: 999px;
  font-size: 0.7rem;
  font-weight: 700;
  color: rgba(185, 28, 28, 0.9);
  background: rgba(239, 68, 68, 0.12);
}

.start-flow-meta {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 8px;
}

.start-flow-meta .meta-label {
  display: inline-flex;
  align-items: center;
  padding: 2px 8px;
  border-radius: 999px;
  font-size: 0.75rem;
  font-weight: 700;
  color: rgba(15, 23, 42, 0.7);
  background: rgba(15, 23, 42, 0.06);
}

.start-flow-meta .meta-value {
  font-weight: 600;
}

.start-flow-subtitle {
  margin: 0;
  font-size: 0.8rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
}

.start-flow-grid {
  display: grid;
  gap: 12px;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
}

.start-choice-grid {
  display: grid;
  gap: 18px;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
}

.start-choice-card {
  border-radius: 20px;
  border: 1px solid rgba(0, 0, 0, 0.12);
  background: rgba(255, 255, 255, 0.9);
  padding: 28px;
  text-align: left;
  cursor: pointer;
  transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
  display: grid;
  gap: 10px;
  min-height: 160px;
}

.start-choice-card:hover {
  transform: translateY(-2px);
  border-color: rgba(224, 107, 79, 0.45);
  box-shadow: 0 16px 28px rgba(17, 24, 39, 0.12);
}

.start-choice-card:focus-visible {
  outline: 3px solid rgba(224, 107, 79, 0.35);
  outline-offset: 2px;
  border-color: rgba(224, 107, 79, 0.55);
  box-shadow: 0 18px 30px rgba(224, 107, 79, 0.2);
}

.start-choice-card.is-recommended {
  border-color: rgba(224, 107, 79, 0.7);
  box-shadow: 0 18px 32px rgba(224, 107, 79, 0.18);
}

.start-choice-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
}

.start-choice-title {
  font-size: 1.35rem;
  font-weight: 700;
}

.start-choice-sub {
  margin: 0;
  color: var(--muted);
  font-size: 0.98rem;
}

.start-choice-latest {
  margin: 0;
  font-size: 0.78rem;
  color: rgba(17, 24, 39, 0.7);
}

.ui-template-grid {
  display: grid;
  gap: 16px;
  grid-template-columns: minmax(220px, 1fr) minmax(280px, 1.4fr);
  align-items: start;
}

.ui-template-list {
  display: grid;
  gap: 12px;
}

.ui-template-preview {
  display: grid;
  gap: 10px;
}

.ui-template-preview-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
}

.ui-template-preview-title {
  font-weight: 600;
}

.ui-template-preview-frame {
  position: relative;
  border-radius: 18px;
  border: 1px solid rgba(0, 0, 0, 0.12);
  background: rgba(255, 255, 255, 0.8);
  overflow: hidden;
  min-height: 320px;
  aspect-ratio: 16 / 10;
}

.ui-template-preview-frame iframe {
  width: 100%;
  height: 100%;
  border: 0;
  display: block;
  background: #fff;
}

.ui-template-preview-overlay {
  position: absolute;
  inset: 0;
  display: grid;
  place-content: center;
  gap: 6px;
  text-align: center;
  padding: 16px;
  background: rgba(255, 255, 255, 0.9);
  color: rgba(17, 24, 39, 0.8);
  font-size: 0.85rem;
}

.ui-template-preview-overlay p {
  margin: 0;
}

.ui-template-preview-overlay a {
  color: rgba(224, 107, 79, 0.9);
  font-weight: 600;
}

.ui-template-preview-empty {
  border-radius: 16px;
  border: 1px dashed rgba(0, 0, 0, 0.16);
  background: rgba(255, 255, 255, 0.7);
  padding: 16px;
  display: grid;
  gap: 6px;
  color: var(--muted);
}

.ui-template-preview-link {
  font-weight: 600;
  color: rgba(224, 107, 79, 0.9);
}

.demo-preview-overlay {
  position: fixed;
  inset: 0;
  background: rgba(15, 23, 42, 0.66);
  display: none;
  align-items: stretch;
  justify-content: center;
  z-index: 1900;
}

.demo-preview-overlay.open {
  display: flex;
}

.demo-preview-shell {
  width: 100%;
  height: 100%;
  background: #f8fafc;
  display: flex;
  flex-direction: column;
}

.demo-preview-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding: 12px 16px;
  background: #ffffff;
  border-bottom: 1px solid rgba(15, 23, 42, 0.12);
}

.demo-preview-title {
  font-weight: 700;
  font-size: 1rem;
}

.demo-preview-body {
  flex: 1;
  background: #e2e8f0;
}

.demo-preview-body iframe {
  width: 100%;
  height: 100%;
  border: 0;
  display: block;
  background: #ffffff;
}

body.demo-preview-open {
  overflow: hidden;
}

.ui-template-message {
  display: grid;
  gap: 8px;
  align-items: start;
}

.start-flow-choice {
  border-radius: 16px;
  border: 1px solid rgba(0, 0, 0, 0.12);
  background: rgba(255, 255, 255, 0.75);
  padding: 14px;
  text-align: left;
  cursor: pointer;
  transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
}

.start-flow-choice:hover {
  transform: translateY(-1px);
}

.start-flow-choice.is-selected {
  border-color: rgba(224, 107, 79, 0.7);
  box-shadow: 0 16px 28px rgba(224, 107, 79, 0.18);
}

.start-flow-choice-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  margin-bottom: 8px;
}

.start-flow-choice-title {
  font-weight: 600;
}

.start-flow-list {
  display: grid;
  gap: 12px;
}

.project-highlight-card {
  border-radius: 20px;
  border: 1px solid rgba(224, 107, 79, 0.25);
  background: rgba(255, 255, 255, 0.92);
  padding: 18px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
  box-shadow: 0 16px 28px rgba(224, 107, 79, 0.14);
}

.project-highlight-label {
  font-size: 0.75rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: rgba(224, 107, 79, 0.9);
  font-weight: 700;
}

.project-highlight-title {
  font-size: 1.1rem;
  font-weight: 700;
}

.project-list-toolbar {
  display: grid;
  gap: 12px;
  grid-template-columns: minmax(0, 1fr) auto;
  align-items: end;
  position: sticky;
  top: 12px;
  padding: 12px 0;
  background: rgba(255, 255, 255, 0.92);
  z-index: 2;
}

.project-search {
  display: grid;
  gap: 8px;
}

.project-filter-toggle {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  font-size: 12px;
  color: var(--muted);
}

.project-filter-toggle input {
  accent-color: rgba(224, 107, 79, 0.8);
}

.project-row-actions {
  display: flex;
  align-items: center;
  gap: 8px;
}

.project-row-menu {
  position: relative;
}

.project-row-menu-panel {
  position: absolute;
  right: 0;
  top: calc(100% + 6px);
  min-width: 160px;
  background: rgba(255, 255, 255, 0.98);
  border: 1px solid rgba(0, 0, 0, 0.08);
  border-radius: 12px;
  padding: 8px;
  box-shadow: 0 12px 24px rgba(0, 0, 0, 0.12);
  z-index: 3;
  writing-mode: horizontal-tb;
}

.project-row-menu-panel .btn {
  width: 100%;
  text-align: left;
  white-space: nowrap;
  writing-mode: horizontal-tb;
}

.start-flow-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding: 12px 14px;
  border-radius: 16px;
  border: 1px solid rgba(0, 0, 0, 0.08);
  background: rgba(255, 255, 255, 0.75);
}

.start-flow-row-main {
  display: grid;
  gap: 4px;
  min-width: 0;
}

.start-flow-row-title {
  font-weight: 600;
}

.project-folder-link {
  border: none;
  background: transparent;
  padding: 0;
  margin: 0 4px;
  font: inherit;
  font-weight: 600;
  color: #2563eb;
  text-decoration: underline;
  cursor: pointer;
}

.project-folder-link:disabled {
  cursor: not-allowed;
  color: rgba(37, 99, 235, 0.5);
  text-decoration: none;
}

.start-flow-alt {
  display: grid;
  gap: 12px;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
}

.start-flow-actions .btn {
  min-width: 160px;
}

@media (max-width: 720px) {
  .project-highlight-card {
    flex-direction: column;
    align-items: flex-start;
  }

  .project-list-toolbar {
    grid-template-columns: 1fr;
    position: static;
    padding: 0;
  }

  .project-row-actions {
    flex-direction: column;
    align-items: stretch;
  }
}

.hero-link {
  display: inline-flex;
  align-items: center;
  padding: 6px 14px;
  border-radius: 999px;
  border: 1px solid rgba(20, 20, 20, 0.12);
  background: rgba(255, 255, 255, 0.7);
  color: var(--text);
  font-size: 0.85rem;
  font-weight: 600;
  text-decoration: none;
  box-shadow: 0 10px 20px rgba(31, 27, 22, 0.08);
  transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
}

.hero-link:hover {
  transform: translateY(-1px);
  background: rgba(255, 255, 255, 0.95);
}

.stack {
  display: grid;
  gap: 24px;
}

.card {
  position: relative;
  padding: 24px;
  background: var(--card);
  border-radius: var(--radius);
  border: 1px solid var(--border);
  box-shadow: var(--shadow);
  backdrop-filter: blur(12px);
  animation: floatIn 0.6s ease both;
}

.stack .card:nth-child(1) {
  animation-delay: 0.05s;
}

.stack .card:nth-child(2) {
  animation-delay: 0.12s;
}

.stack .card:nth-child(3) {
  animation-delay: 0.2s;
}

.stack .card:nth-child(4) {
  animation-delay: 0.28s;
}

.stack .card:nth-child(5) {
  animation-delay: 0.36s;
}

.stack .card:nth-child(6) {
  animation-delay: 0.44s;
}

.stack .card:nth-child(7) {
  animation-delay: 0.52s;
}

.stack .card:nth-child(8) {
  animation-delay: 0.6s;
}

.card-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: 12px;
  margin-bottom: 16px;
}

.card-header > * {
  min-width: 0;
}

h2 {
  margin: 0;
  font-size: 1rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
}

.label {
  display: inline-block;
  margin-bottom: 6px;
  font-size: 0.85rem;
  color: var(--muted);
}

.row {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  align-items: center;
}

.tab-row {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin: 6px 0 14px;
}

.tab-btn {
  border-radius: 999px;
  border: 1px solid rgba(30, 30, 30, 0.2);
  padding: 8px 18px;
  background: rgba(255, 255, 255, 0.7);
  color: var(--text);
  font-weight: 600;
  letter-spacing: 0.04em;
  text-transform: uppercase;
  font-size: 0.75rem;
  cursor: pointer;
  transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
}

.tab-btn:hover {
  transform: translateY(-1px);
}

.tab-btn.is-active {
  background: var(--accent);
  color: #fff;
  border-color: rgba(224, 107, 79, 0.6);
  box-shadow: 0 12px 20px rgba(224, 107, 79, 0.18);
}

.input,
.textarea,
.select {
  width: 100%;
  border-radius: 12px;
  border: 1px solid rgba(30, 30, 30, 0.2);
  padding: 12px 14px;
  font-size: 0.95rem;
  background: rgba(255, 255, 255, 0.9);
  color: var(--text);
  transition: border 0.2s ease, box-shadow 0.2s ease;
}

.input:focus,
.textarea:focus,
.select:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(224, 107, 79, 0.15);
}

.textarea {
  resize: vertical;
  min-height: 120px;
}

.btn {
  border: none;
  border-radius: 999px;
  padding: 10px 18px;
  font-size: 0.9rem;
  font-weight: 600;
  background: #fff0ea;
  color: var(--accent-strong);
  cursor: pointer;
  transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
  box-shadow: 0 10px 20px rgba(224, 107, 79, 0.16);
}

.btn:hover {
  transform: translateY(-1px);
  background: #ffe6db;
}

.btn:disabled {
  cursor: not-allowed;
  opacity: 0.6;
  box-shadow: none;
}

.btn.primary {
  background: var(--accent);
  color: #fff;
  box-shadow: 0 16px 28px rgba(224, 107, 79, 0.28);
}

.btn.primary:hover {
  background: var(--accent-strong);
}

.btn.primary.emphasis {
  box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.3), 0 18px 32px rgba(224, 107, 79, 0.3);
}

.btn.danger {
  background: #fbe9e7;
  color: #b3261e;
  box-shadow: 0 12px 24px rgba(179, 38, 30, 0.18);
}

.btn.danger:hover {
  background: #f7d8d4;
}

.btn.ghost {
  background: rgba(255, 255, 255, 0.6);
  color: var(--text);
  box-shadow: none;
}

.btn.ghost:hover {
  background: rgba(255, 255, 255, 0.85);
}

.hint {
  margin: 12px 0 0;
  font-size: 0.85rem;
  color: var(--muted);
}

.error {
  margin: 8px 0 0;
  font-size: 0.85rem;
  color: #b3261e;
}

.pairing-section {
  margin-top: 20px;
  display: grid;
  gap: 16px;
}

.pairing-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: 12px;
}

.pairing-header h3 {
  margin: 0;
  font-size: 0.9rem;
  text-transform: uppercase;
  letter-spacing: 0.08em;
}

.pairing-grid {
  display: grid;
  gap: 16px;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
}

.pairing-block {
  padding: 16px;
  border-radius: 16px;
  border: 1px solid rgba(0, 0, 0, 0.08);
  background: rgba(255, 255, 255, 0.7);
  display: grid;
  gap: 12px;
}

.pairing-block-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: 12px;
}

.pairing-header > *,
.pairing-block-header > * {
  min-width: 0;
}

.pairing-block-header h4 {
  margin: 0;
  font-size: 0.8rem;
  text-transform: uppercase;
  letter-spacing: 0.08em;
}

.pairing-meta {
  display: grid;
  gap: 12px;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
}

.qr-frame {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 200px;
  border-radius: 16px;
  border: 1px dashed rgba(31, 27, 22, 0.2);
  background: rgba(255, 255, 255, 0.9);
}

.qr-image {
  width: 180px;
  height: 180px;
  object-fit: contain;
}

.qr-placeholder {
  margin: 0;
  text-align: center;
  color: var(--muted);
  font-size: 0.85rem;
  padding: 12px;
}

.scanner-frame {
  position: relative;
  border-radius: 16px;
  overflow: hidden;
  min-height: 200px;
  background: #101312;
  display: flex;
  align-items: center;
  justify-content: center;
}

.scanner-video {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.scanner-placeholder {
  margin: 0;
  color: rgba(245, 241, 234, 0.7);
  font-size: 0.85rem;
  padding: 12px;
  text-align: center;
}

.settings {
  display: grid;
  gap: 16px;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
}

.quick-toggles {
  display: grid;
  gap: 20px;
}

.toggle-section {
  display: grid;
  gap: 10px;
}

.toggle-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: 12px;
}

.toggle-subheader {
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: 10px;
}

.toggle-header > * {
  min-width: 0;
}

.toggle-grid {
  display: grid;
  gap: 12px;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
}

.toggle-btn {
  border: 1px solid rgba(0, 0, 0, 0.12);
  border-radius: 16px;
  padding: 12px 14px;
  background: rgba(255, 255, 255, 0.85);
  text-align: left;
  cursor: pointer;
  transition: transform 0.2s ease, border 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;
  box-shadow: 0 10px 20px rgba(30, 30, 30, 0.08);
}

.toggle-btn:hover {
  transform: translateY(-1px);
  border-color: rgba(0, 0, 0, 0.2);
  box-shadow: 0 16px 24px rgba(30, 30, 30, 0.12);
}

.toggle-btn.active {
  background: rgba(224, 107, 79, 0.15);
  border-color: rgba(224, 107, 79, 0.45);
  box-shadow: 0 16px 24px rgba(224, 107, 79, 0.2);
}

.toggle-btn.toggle-danger.active {
  background: rgba(179, 38, 30, 0.14);
  border-color: rgba(179, 38, 30, 0.4);
  box-shadow: 0 16px 24px rgba(179, 38, 30, 0.2);
}

.toggle-label {
  display: block;
  font-weight: 600;
  color: var(--text);
}

.toggle-note {
  display: block;
  margin-top: 4px;
  font-size: 0.78rem;
  color: var(--muted);
}

.toggle-btn.active .toggle-label {
  color: var(--accent-strong);
}

.toggle-btn.active .toggle-note {
  color: rgba(31, 27, 22, 0.8);
}

.toggle-btn.toggle-danger.active .toggle-label {
  color: var(--danger);
}

.toggle-advanced {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  flex-wrap: wrap;
}

.toggle-details {
  border: 1px dashed rgba(0, 0, 0, 0.18);
  border-radius: 16px;
  padding: 10px 12px 12px;
  background: rgba(255, 255, 255, 0.6);
}

.toggle-details summary {
  cursor: pointer;
  font-weight: 600;
  color: var(--text);
}

.toggle-details summary::marker {
  color: var(--muted);
}

.toggle-details .toggle-grid {
  margin-top: 12px;
}

.quick-summary {
  display: grid;
  gap: 16px;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
}

.quick-note {
  margin: 4px 0 0;
}

.usage-grid {
  display: grid;
  gap: 16px;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
}

.usage-grid + .usage-grid {
  margin-top: 16px;
}

.account-grid {
  display: grid;
  gap: 12px;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  margin-bottom: 12px;
}

.planner-grid {
  display: grid;
  gap: 16px;
}

.planner-question {
  padding: 14px;
  border-radius: 16px;
  border: 1px solid rgba(30, 30, 30, 0.1);
  background: rgba(255, 255, 255, 0.8);
}

.planner-question .micro {
  margin-top: 0;
}

.planner-textarea {
  margin-top: 6px;
}

.planner-suggestions {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 10px;
}

.planner-suggestion {
  border-radius: 999px;
  border: 1px dashed rgba(30, 30, 30, 0.2);
  padding: 6px 12px;
  background: rgba(255, 255, 255, 0.6);
  font-size: 0.75rem;
  color: var(--muted);
  cursor: pointer;
}

.planner-suggestion.is-recommended {
  border-color: rgba(224, 107, 79, 0.6);
  color: var(--accent-strong);
  font-weight: 600;
}

.planner-actions {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin-top: 16px;
}

.planner-checklist {
  position: sticky;
  top: 0;
  z-index: 4;
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(4px);
}

.planner-checklist .row-actions {
  display: flex;
  gap: 8px;
  align-items: center;
}

.planner-checklist-summary {
  display: grid;
  gap: 6px;
}

.planner-checklist-summary .summary-row {
  display: flex;
  justify-content: space-between;
  font-size: 12px;
  color: rgba(17, 24, 39, 0.7);
}

.planner-checklist-summary.is-collapsed {
  gap: 4px;
}

.planner-checklist-summary .summary-next {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  align-items: center;
  font-size: 12px;
  color: rgba(17, 24, 39, 0.75);
}

.planner-checklist-summary .summary-next .next-badge {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 2px 6px;
  border-radius: 999px;
  background: rgba(197, 82, 57, 0.15);
  color: rgba(197, 82, 57, 0.9);
  font-weight: 700;
  font-size: 11px;
}

.planner-checklist-summary .summary-next .next-label {
  font-weight: 600;
}

.planner-checklist-summary .summary-next .next-hint {
  color: rgba(17, 24, 39, 0.6);
}

.progress-bar {
  height: 6px;
  border-radius: 999px;
  background: rgba(17, 24, 39, 0.08);
  overflow: hidden;
}

.progress-bar-fill {
  height: 100%;
  background: linear-gradient(90deg, #16a34a, #22c55e);
}

.planner-checklist-items {
  display: flex;
  flex-direction: column;
  gap: 6px;
  margin-top: 8px;
}

.planner-checklist-item {
  display: grid;
  grid-template-columns: 52px minmax(120px, 1fr) minmax(80px, 1fr);
  gap: 8px;
  align-items: center;
  padding: 8px 10px;
  border-radius: 10px;
  border: 1px solid rgba(17, 24, 39, 0.1);
  background: #fff;
  text-align: left;
}

.planner-checklist-item .status {
  font-size: 12px;
  font-weight: 700;
  color: rgba(17, 24, 39, 0.8);
}

.planner-checklist-item .label {
  font-weight: 600;
  font-size: 13px;
  color: rgba(17, 24, 39, 0.85);
}

.planner-checklist-item .value {
  font-size: 12px;
  color: rgba(17, 24, 39, 0.6);
  text-align: right;
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 2;
  overflow: hidden;
}

.planner-checklist-item.locked .label::after {
  content: " LOCK";
  font-size: 10px;
  color: rgba(17, 24, 39, 0.45);
}

.planner-checklist-item.status-done {
  border-color: rgba(34, 197, 94, 0.35);
  background: rgba(34, 197, 94, 0.08);
}

.planner-checklist-item.status-in_progress {
  border-color: rgba(59, 130, 246, 0.35);
  background: rgba(59, 130, 246, 0.08);
}

.planner-checklist-item.status-tbd {
  border-color: rgba(249, 115, 22, 0.35);
  background: rgba(249, 115, 22, 0.08);
}

.planner-checklist-item.status-skip {
  border-color: rgba(107, 114, 128, 0.35);
  background: rgba(107, 114, 128, 0.08);
}

.planner-checklist-item.is-next {
  border-left: 4px solid rgba(197, 82, 57, 0.5);
  border-color: rgba(197, 82, 57, 0.25);
  background: rgba(197, 82, 57, 0.08);
}

.planner-checklist-item.is-next .label {
  font-weight: 700;
}

.planner-checklist-item.is-next .status {
  color: rgba(197, 82, 57, 0.9);
}

.planner-checklist-next {
  margin-top: 8px;
  font-size: 12px;
  color: rgba(17, 24, 39, 0.7);
}

.planner-checklist-editor {
  margin-top: 12px;
  padding: 12px;
  border-radius: 12px;
  border: 1px dashed rgba(17, 24, 39, 0.2);
  background: rgba(15, 23, 42, 0.03);
  display: grid;
  gap: 8px;
}

.planner-checklist-editor .editor-title {
  font-weight: 700;
  font-size: 13px;
}

.planner-checklist-editor .editor-meta {
  font-size: 12px;
  color: rgba(17, 24, 39, 0.7);
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.planner-checklist-actions {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}

@media (max-width: 720px) {
  .planner-checklist-item {
    grid-template-columns: 46px 1fr;
    grid-template-rows: auto auto;
  }
  .planner-checklist-item .value {
    grid-column: 2 / 3;
    text-align: left;
  }
}

.builder-grid {
  display: grid;
  gap: 12px;
  margin-top: 12px;
}

.builder-check {
  padding: 12px 14px;
  border-radius: 14px;
  border: 1px solid rgba(30, 30, 30, 0.1);
  background: rgba(255, 255, 255, 0.75);
  display: grid;
  gap: 4px;
}

.status-ok {
  color: var(--mint);
  font-weight: 600;
}

.status-missing {
  color: var(--danger);
  font-weight: 600;
}

.builder-actions {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin-top: 16px;
}

.doctor-actions {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin: 12px 0;
}

.usage-block {
  padding: 16px;
  border-radius: 16px;
  border: 1px solid rgba(0, 0, 0, 0.08);
  background: rgba(255, 255, 255, 0.75);
}

.usage-title {
  margin: 0 0 12px;
  font-size: 0.8rem;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: var(--muted);
}

.usage-rows {
  display: grid;
  gap: 10px;
}

.usage-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: 12px;
}

.usage-row > * {
  min-width: 0;
}

.usage-label {
  font-size: 0.85rem;
  color: var(--muted);
}

.usage-value {
  padding: 4px 10px;
  border-radius: 999px;
  background: rgba(224, 107, 79, 0.12);
  color: var(--accent-strong);
  font-weight: 600;
  font-family: 'IBM Plex Mono', 'SFMono-Regular', ui-monospace, monospace;
  font-size: 0.85rem;
}

.usage-unknown {
  background: rgba(18, 23, 22, 0.08);
  color: var(--muted);
}

.pill {
  margin-top: 6px;
  padding: 10px 14px;
  background: rgba(240, 245, 240, 0.9);
  border-radius: 12px;
  border: 1px solid rgba(47, 122, 102, 0.25);
  color: var(--mint);
  font-weight: 600;
}

.pill-ok {
  background: rgba(217, 245, 232, 0.9);
  border-color: rgba(47, 122, 102, 0.35);
  color: var(--mint);
}

.pill-warn {
  background: rgba(255, 241, 222, 0.9);
  border-color: rgba(182, 106, 34, 0.35);
  color: #b66a22;
}

.pill-danger {
  background: rgba(255, 232, 224, 0.9);
  border-color: rgba(179, 38, 30, 0.35);
  color: var(--danger);
}

.micro {
  font-size: 0.8rem;
  color: var(--muted);
}

.subtitle,
.hint,
.error,
.micro,
.pill,
.status-badge,
.auth-summary,
.workspace-summary,
.toggle-label,
.toggle-note,
.usage-label,
.usage-value,
.output-title,
.qr-placeholder,
.scanner-placeholder {
  overflow-wrap: anywhere;
}

.output {
  border: 1px solid rgba(20, 20, 20, 0.18);
}

.output-tabs {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin-bottom: 16px;
}

.output-tab {
  border: 1px solid rgba(0, 0, 0, 0.12);
  background: rgba(255, 255, 255, 0.6);
  color: var(--text);
  border-radius: 999px;
  padding: 8px 16px;
  font-size: 0.85rem;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.2s ease, box-shadow 0.2s ease, transform 0.2s ease;
}

.output-tab:hover {
  transform: translateY(-1px);
  background: rgba(255, 255, 255, 0.85);
}

.output-tab.is-active {
  background: var(--accent);
  color: #fff;
  border-color: rgba(224, 107, 79, 0.6);
  box-shadow: 0 12px 20px rgba(224, 107, 79, 0.18);
}

.output-pane {
  display: grid;
  gap: 12px;
}

.output-toolbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: 12px;
}

.output-toolbar > * {
  min-width: 0;
}

.output-title {
  margin: 0;
  font-size: 0.95rem;
  font-weight: 600;
}

.output-panel {
  background: #121716;
  color: #f5f1ea;
  border-radius: 16px;
  padding: 16px;
  min-height: 180px;
  max-height: 320px;
  overflow-y: auto;
  font-family: 'IBM Plex Mono', 'SFMono-Regular', ui-monospace, monospace;
  font-size: 0.9rem;
}

.output-panel pre {
  margin: 0;
  white-space: pre-wrap;
  word-break: break-word;
}

.placeholder {
  margin: 0;
  color: rgba(245, 241, 234, 0.7);
}

.btn.small {
  padding: 6px 12px;
  font-size: 0.8rem;
  box-shadow: none;
}

.status-badge {
  display: inline-flex;
  align-items: center;
  flex-wrap: wrap;
  gap: 8px;
  padding: 8px 14px;
  border-radius: 999px;
  font-size: 0.85rem;
  font-weight: 600;
  background: rgba(255, 255, 255, 0.7);
  border: 1px solid rgba(0, 0, 0, 0.12);
}

.status-badge > * {
  min-width: 0;
}

.status-dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: #c2c2c2;
}

.status-connected .status-dot {
  background: #35b276;
}

.status-connecting .status-dot {
  background: #f5b454;
}

.status-error .status-dot {
  background: #d15b5b;
}

.chip {
  padding: 6px 12px;
  border-radius: 999px;
  font-size: 0.75rem;
  font-weight: 600;
  border: 1px solid rgba(0, 0, 0, 0.12);
  background: rgba(255, 255, 255, 0.7);
}

.chip-open {
  color: #2f7a66;
  border-color: rgba(47, 122, 102, 0.4);
}

.chip-connecting {
  color: #b66a22;
  border-color: rgba(182, 106, 34, 0.3);
}

.chip-error {
  color: #b3261e;
  border-color: rgba(179, 38, 30, 0.3);
}

.chip-ok {
  color: var(--mint);
  border-color: rgba(47, 122, 102, 0.35);
}

.chip-warn {
  color: #b66a22;
  border-color: rgba(182, 106, 34, 0.35);
}

.chip-unknown {
  color: var(--muted);
  border-color: rgba(0, 0, 0, 0.2);
}

.auth-grid {
  display: grid;
  gap: 16px;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  margin-bottom: 16px;
}

.auth-block {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.auth-summary {
  margin: 0;
  padding: 12px 14px;
  border-radius: 12px;
  border: 1px solid rgba(0, 0, 0, 0.08);
  background: rgba(255, 255, 255, 0.75);
  font-size: 0.9rem;
  color: var(--text);
}

.auth-ok {
  border-color: rgba(47, 122, 102, 0.25);
  color: var(--mint);
}

.auth-warn {
  border-color: rgba(182, 106, 34, 0.3);
  color: #b66a22;
}

.auth-error {
  border-color: rgba(179, 38, 30, 0.3);
  color: #b3261e;
}

.auth-unknown {
  border-color: rgba(0, 0, 0, 0.12);
  color: var(--muted);
}

.workspace-summary {
  margin: 12px 0 0;
  padding: 12px 14px;
  border-radius: 12px;
  border: 1px solid rgba(0, 0, 0, 0.08);
  background: rgba(255, 255, 255, 0.75);
  font-size: 0.9rem;
  color: var(--text);
}

.workspace-ok {
  border-color: rgba(47, 122, 102, 0.25);
  color: var(--mint);
}

.workspace-warn {
  border-color: rgba(182, 106, 34, 0.3);
  color: #b66a22;
}

.workspace-error {
  border-color: rgba(179, 38, 30, 0.3);
  color: #b3261e;
}

.workspace-unknown {
  border-color: rgba(0, 0, 0, 0.12);
  color: var(--muted);
}

.workspace-meta {
  display: grid;
  gap: 16px;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  margin-top: 16px;
}

code {
  padding: 2px 6px;
  border-radius: 6px;
  background: rgba(18, 23, 22, 0.08);
  font-family: 'IBM Plex Mono', 'SFMono-Regular', ui-monospace, monospace;
  font-size: 0.85em;
}

.code-nowrap {
  display: inline-block;
  max-width: 100%;
  white-space: nowrap;
  overflow-wrap: normal;
  word-break: normal;
}

@keyframes floatIn {
  from {
    transform: translateY(8px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

@media (max-width: 980px) {
  .chat-shell {
    grid-template-columns: 1fr;
  }

  .chat-sidebar,
  .chat-detail {
    display: block;
    position: fixed;
    top: 0;
    bottom: 0;
    max-height: none;
    width: min(320px, 86vw);
    background: rgba(247, 240, 231, 0.98);
    padding: 20px;
    box-shadow: 0 20px 40px rgba(31, 27, 22, 0.18);
    z-index: 30;
    transition: transform 0.25s ease;
  }

  .chat-sidebar {
    left: 0;
    transform: translateX(-110%);
  }

  .chat-detail {
    right: 0;
    width: min(380px, 90vw);
    transform: translateX(110%);
  }

  .chat-shell.left-open .chat-sidebar {
    transform: translateX(0);
  }

  .chat-shell.right-open .chat-detail {
    transform: translateX(0);
  }

  .chat-center {
    min-height: calc(100vh - 220px);
  }
}

@media (max-width: 720px) {
  .hero {
    flex-direction: column;
    align-items: flex-start;
  }

  .app {
    padding: 32px 18px 60px;
  }

  .card-header,
  .pairing-header,
  .pairing-block-header,
  .toggle-header,
  .output-toolbar {
    align-items: flex-start;
  }

  .pairing-grid,
  .pairing-meta,
  .toggle-grid,
  .quick-summary,
  .usage-grid,
  .auth-grid,
  .workspace-meta {
    grid-template-columns: 1fr;
  }

  .ui-template-grid {
    grid-template-columns: 1fr;
  }

  .ui-template-preview-frame {
    min-height: 240px;
  }
}

.restoreCard,
.restoreResult {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.plannerCompleteCard {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.plannerSummary {
  border: 1px solid rgba(59, 130, 246, 0.18);
  background: linear-gradient(180deg, rgba(59, 130, 246, 0.08), rgba(15, 23, 42, 0.04));
  border-radius: 14px;
  padding: 16px 18px;
  font-size: 13px;
  color: rgba(15, 23, 42, 0.9);
  white-space: pre-wrap;
  box-shadow: 0 12px 24px -22px rgba(15, 23, 42, 0.6);
}

.plannerSummary .summaryTitle {
  font-weight: 700;
  font-size: 13px;
  letter-spacing: 0.02em;
  margin-bottom: 10px;
}

.plannerSummary .summaryBody {
  white-space: pre-wrap;
  line-height: 1.7;
  font-size: 13.5px;
}

.plannerSummary .summaryQuestion {
  margin-top: 12px;
  font-size: 12.5px;
  color: rgba(51, 65, 85, 0.9);
}

.restoreCard .title,
.restoreResult .title {
  font-weight: 700;
  font-size: 14px;
}

.plannerCompleteCard .title {
  font-weight: 700;
  font-size: 14px;
}

.restoreCard .target {
  font-weight: 700;
  color: var(--text);
}

.restoreCard .sub,
.restoreResult .desc {
  font-size: 12px;
  color: var(--muted);
}

.plannerCompleteCard .desc,
.plannerCompleteCard .note {
  font-size: 12px;
  color: rgba(17, 24, 39, 0.7);
}

.plannerCompleteCard .note {
  color: rgba(17, 24, 39, 0.6);
}

.restoreCard .desc {
  font-size: 12px;
  color: rgba(17, 24, 39, 0.7);
}

.restoreCard .actions {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.plannerCompleteCard .actions {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.plannerEdit {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.plannerEditText {
  white-space: pre-wrap;
  line-height: 1.6;
  font-size: 13px;
}

.plannerEdit .actions {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.builderCompleteCard {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.builderCompleteCard .title {
  font-weight: 700;
  font-size: 14px;
}

.builderCompleteCard .desc {
  font-size: 12px;
  color: rgba(17, 24, 39, 0.7);
}

.builderCompleteCard .actions {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.builderCompleteSummary {
  display: flex;
  flex-direction: column;
  gap: 6px;
  border-radius: 10px;
  border: 1px solid rgba(15, 23, 42, 0.08);
  background: rgba(15, 23, 42, 0.03);
  padding: 10px;
  font-size: 12px;
}

.builderCompleteSummary .summaryRow {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  align-items: flex-start;
}

.builderCompleteSummary .label {
  font-weight: 600;
  color: rgba(17, 24, 39, 0.75);
  min-width: 140px;
}

.builderCompleteSummary .value {
  color: rgba(17, 24, 39, 0.85);
  flex: 1 1 auto;
}

.builderCompleteSummary .summaryList {
  margin: 0;
  padding-left: 18px;
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.statusTag {
  display: inline-flex;
  align-items: center;
  padding: 2px 8px;
  border-radius: 999px;
  border: 1px solid rgba(15, 23, 42, 0.1);
  font-size: 11px;
  font-weight: 600;
  background: rgba(15, 23, 42, 0.06);
  color: rgba(17, 24, 39, 0.8);
}

.statusTag.ok {
  border-color: rgba(16, 185, 129, 0.4);
  background: rgba(16, 185, 129, 0.12);
  color: rgba(6, 95, 70, 0.95);
}

.statusTag.attention {
  border-color: rgba(217, 119, 6, 0.4);
  background: rgba(251, 191, 36, 0.12);
  color: rgba(146, 64, 14, 0.95);
}

.statusTag.needsFix {
  border-color: rgba(239, 68, 68, 0.4);
  background: rgba(239, 68, 68, 0.12);
  color: rgba(153, 27, 27, 0.95);
}

.statusTag.idle {
  border-color: rgba(15, 23, 42, 0.12);
  background: rgba(15, 23, 42, 0.04);
  color: rgba(17, 24, 39, 0.7);
}

.builderConsult {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 10px;
  border-radius: 10px;
  border: 1px dashed rgba(15, 23, 42, 0.12);
  background: rgba(15, 23, 42, 0.02);
}

.builderConsult .consultChips {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
}

.builderConsult .chip.selected {
  border-color: rgba(47, 122, 102, 0.5);
  background: rgba(16, 185, 129, 0.12);
  color: rgba(6, 95, 70, 0.95);
}

.builderCompleteDetails {
  font-size: 12px;
  color: rgba(17, 24, 39, 0.7);
}

.builderCompleteDetails summary {
  cursor: pointer;
  font-weight: 600;
}

.builderCompleteDetails .detailSection {
  margin-top: 8px;
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.builderCompleteDetails .fileList {
  margin: 0;
  padding-left: 18px;
}

.builderCompleteDetails .logPane {
  background: rgba(15, 23, 42, 0.06);
  border: 1px solid rgba(15, 23, 42, 0.08);
  border-radius: 8px;
  padding: 8px;
  font-size: 11px;
  line-height: 1.5;
  white-space: pre-wrap;
}

.verifyResult {
  border-radius: 10px;
  padding: 10px;
  border: 1px solid rgba(15, 23, 42, 0.1);
  background: rgba(15, 23, 42, 0.03);
  font-size: 12px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.verifyResult.ok {
  border-color: rgba(16, 185, 129, 0.5);
  background: rgba(16, 185, 129, 0.08);
}

.verifyResult.needsFix {
  border-color: rgba(239, 68, 68, 0.4);
  background: rgba(239, 68, 68, 0.08);
}

.verifyResult.attention {
  border-color: rgba(217, 119, 6, 0.4);
  background: rgba(251, 191, 36, 0.12);
}

.verifyResult .checks {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.verifyResult .check {
  display: flex;
  align-items: center;
  gap: 6px;
  flex-wrap: wrap;
}

.verifyResult .badge {
  font-size: 10px;
  font-weight: 700;
  padding: 2px 6px;
  border-radius: 999px;
  background: rgba(15, 23, 42, 0.15);
}

.verifyResult .badge.ok {
  background: rgba(16, 185, 129, 0.25);
}

.verifyResult .badge.needsFix {
  background: rgba(239, 68, 68, 0.25);
}

.verifyResult .badge.attention {
  background: rgba(251, 191, 36, 0.35);
  color: rgba(146, 64, 14, 0.9);
}

.verifyResult .badge.skip {
  background: rgba(15, 23, 42, 0.12);
  color: rgba(17, 24, 39, 0.7);
}

.verifyResult .note {
  color: rgba(17, 24, 39, 0.65);
}

.verifyResult .verifyActions {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.verifyResult .verifyFallbackActions {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
}

.verifyDetails {
  border-top: 1px dashed rgba(15, 23, 42, 0.18);
  padding-top: 6px;
}

.verifyDetails summary {
  cursor: pointer;
  font-weight: 600;
}

.logBlock {
  margin: 8px 0;
  border-radius: 10px;
  border: 1px solid rgba(15, 23, 42, 0.08);
  background: rgba(15, 23, 42, 0.04);
  padding: 8px;
  font-size: 12px;
}

.logBlock summary {
  cursor: pointer;
  font-weight: 600;
  margin-bottom: 6px;
}

.logBlock pre {
  margin: 0;
  white-space: pre-wrap;
  font-size: 11px;
  line-height: 1.5;
}

.messageBlock {
  display: block;
}

.workingIndicator {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  margin-top: 8px;
  font-size: 12px;
  color: var(--muted);
}

.workingIndicator .spinner {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  border: 2px solid rgba(15, 23, 42, 0.2);
  border-top-color: rgba(15, 23, 42, 0.6);
  animation: cc-spin 0.9s linear infinite;
}

@keyframes cc-spin {
  to {
    transform: rotate(360deg);
  }
}

.plannerCompleteDetails {
  font-size: 12px;
  color: rgba(17, 24, 39, 0.7);
}

.plannerCompleteDetails summary {
  cursor: pointer;
  font-weight: 600;
}

.boot-error {
  max-width: 720px;
  margin: 18vh auto 0;
  padding: 24px;
  border-radius: 16px;
  background: rgba(255, 255, 255, 0.92);
  border: 1px solid rgba(15, 23, 42, 0.12);
  box-shadow: var(--shadow);
  color: var(--text);
  text-align: left;
}

.boot-error h1 {
  margin: 0 0 8px;
  font-size: 20px;
}

.boot-error p {
  margin: 0 0 16px;
  color: var(--muted);
}

.boot-error-actions {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}

.boot-error-btn {
  border: 1px solid rgba(17, 24, 39, 0.2);
  border-radius: 10px;
  background: #fff;
  color: var(--text);
  padding: 8px 14px;
  cursor: pointer;
  font-weight: 600;
}

.boot-error-btn:hover {
  background: rgba(17, 24, 39, 0.04);
}

.restoreResult .row {
  font-size: 12px;
  color: rgba(17, 24, 39, 0.75);
}

.restoreResult .warn {
  font-size: 12px;
  color: #b45309;
}

.statusCard {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.statusCard .title {
  font-weight: 700;
  font-size: 14px;
}

.statusCard .rows {
  display: grid;
  gap: 6px;
}

.statusCard .row {
  display: flex;
  justify-content: space-between;
  gap: 12px;
  font-size: 12px;
  color: rgba(17, 24, 39, 0.75);
}

.statusCard .label {
  color: var(--muted);
}

.statusCard .value {
  color: rgba(17, 24, 39, 0.9);
  font-weight: 600;
  text-align: right;
}

.statusCard .note {
  font-size: 12px;
  color: rgba(17, 24, 39, 0.7);
}

.statusCard .note.error {
  color: #b91c1c;
}

.version-list {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.version-card {
  border: 1px solid rgba(17, 24, 39, 0.12);
  border-radius: 12px;
  padding: 12px;
  display: flex;
  flex-direction: column;
  gap: 6px;
  background: rgba(255, 255, 255, 0.7);
}

.version-head {
  display: flex;
  justify-content: space-between;
  gap: 8px;
}

.version-title {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.version-id {
  font-weight: 800;
  font-size: 13px;
}

.version-name {
  font-size: 13px;
  color: rgba(17, 24, 39, 0.7);
}

.version-time {
  font-size: 12px;
  color: var(--muted);
}

.version-stats {
  font-size: 12px;
  color: rgba(17, 24, 39, 0.75);
}

.version-summary {
  font-size: 12px;
  color: rgba(17, 24, 39, 0.75);
  line-height: 1.5;
}

.version-files {
  font-size: 12px;
  color: var(--muted);
}

.version-empty {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.version-actions {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.version-detail {
  margin-top: 12px;
  padding-top: 10px;
  border-top: 1px dashed rgba(17, 24, 39, 0.12);
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.version-detail-head {
  display: flex;
  justify-content: space-between;
  gap: 8px;
  align-items: center;
}

.version-detail-list {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.version-detail-patch {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.version-detail-code {
  font-family: var(--mono);
  font-size: 11px;
  line-height: 1.4;
  padding: 10px;
  border-radius: 10px;
  border: 1px solid rgba(0, 0, 0, 0.08);
  background: rgba(17, 24, 39, 0.04);
  max-height: 220px;
  overflow: auto;
  white-space: pre;
}

.version-detail-row {
  display: grid;
  grid-template-columns: auto 1fr auto;
  gap: 8px;
  font-size: 12px;
  color: rgba(17, 24, 39, 0.75);
}

.version-detail-row .path {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.version-detail-row .stat {
  font-variant-numeric: tabular-nums;
}

.badge {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 20px;
  padding: 2px 6px;
  border-radius: 999px;
  font-size: 11px;
  background: rgba(17, 24, 39, 0.08);
}

.badge-A {
  background: rgba(34, 197, 94, 0.15);
  color: #15803d;
}

.badge-M {
  background: rgba(59, 130, 246, 0.15);
  color: #1d4ed8;
}

.badge-D {
  background: rgba(239, 68, 68, 0.15);
  color: #b91c1c;
}


.demo-disclaimer {
  position: sticky;
  top: 0;
  z-index: 100;
  background: rgba(17, 24, 39, 0.92);
  color: #f8fafc;
  border-bottom: 1px solid rgba(255, 255, 255, 0.12);
  backdrop-filter: blur(6px);
}

.demo-disclaimer .demo-disclaimer-inner {
  max-width: 980px;
  margin: 0 auto;
  padding: 10px 24px;
  font-size: 0.72rem;
  line-height: 1.5;
  display: grid;
  gap: 4px;
}

.demo-disclaimer strong {
  color: #fff;
  font-weight: 600;
}

.demo-app {
  padding-top: 24px;
  transition: transform 0.35s ease;
  transform-origin: center top;
}

.demo-zoom .demo-app {
  transform: scale(1.02);
}

.demo-app.chat-app {
  height: calc(100vh - var(--demo-disclaimer-height) - var(--demo-cta-height));
  padding-top: 0;
}

.demo-footer {
  margin-top: 20px;
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  align-items: center;
  justify-content: space-between;
}

.demo-progress {
  height: 10px;
  border-radius: 999px;
  background: rgba(0, 0, 0, 0.08);
  overflow: hidden;
}

.demo-progress > span {
  display: block;
  height: 100%;
  width: 0%;
  background: linear-gradient(90deg, rgba(224, 107, 79, 0.7), rgba(224, 107, 79, 1));
  transition: width 0.3s ease;
}

.demo-log {
  margin-top: 12px;
}

.demo-log .output-panel {
  min-height: 140px;
}

.demo-start-flow.is-hidden {
  display: none;
}

.demo-work-flow {
  display: none;
}

.demo-work-flow.is-active {
  display: contents;
}

.demo-work-panel {
  display: flex;
  flex-direction: column;
  min-height: 0;
  flex: 1;
}

.demo-work-panel .chat {
  display: flex;
  flex-direction: column;
  min-height: 0;
  flex: 1;
}

.demo-work-panel .messages {
  flex: 1;
  min-height: 0;
  overflow: auto;
}

.demo-work-panel .centerCol {
  min-height: 0;
}

.demo-work-flow[data-mode="planner"] .demo-work-panel-builder {
  display: none;
}

.demo-work-flow[data-mode="builder"] .demo-work-panel-planner {
  display: none;
}

.demo-work-flow[data-mode="planner"] .demo-next-action {
  display: none;
}

.demo-cursor {
  --cursor-scale: 1;
  position: fixed;
  width: 28px;
  height: 28px;
  background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='28' height='28' viewBox='0 0 28 28'><path d='M4 3 L4 22 L9.5 17.5 L12.5 25 L16 23.6 L12.6 16.5 L20.5 16.5 Z' fill='%23ffffff' stroke='%23000000' stroke-width='1.2' stroke-linejoin='round'/></svg>");
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  border-radius: 0;
  pointer-events: none;
  z-index: 2000;
  filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.35));
  transform: translate(-4px, -4px) scale(var(--cursor-scale));
  transition: left 0.6s ease, top 0.6s ease, transform 0.2s ease;
}

.demo-cursor.is-clicking {
  --cursor-scale: 0.9;
}

.demo-cursor-ring {
  position: fixed;
  width: 32px;
  height: 32px;
  border-radius: 50%;
  border: 2px solid rgba(224, 107, 79, 0.45);
  box-shadow: 0 0 0 6px rgba(224, 107, 79, 0.12);
  pointer-events: none;
  z-index: 1999;
  transform: translate(-50%, -50%);
  opacity: 0;
  transition: opacity 0.25s ease;
}

.demo-cursor-ring.is-visible {
  opacity: 1;
}

.demo-hidden {
  display: none !important;
}

.demo-frozen {
  opacity: 0.45;
  filter: grayscale(0.15);
  pointer-events: none;
}

.demo-frozen .btn,
.demo-frozen.btn {
  pointer-events: none;
}

.demo-cta {
  position: sticky;
  top: var(--demo-disclaimer-height);
  z-index: 120;
  background: rgba(255, 247, 237, 0.98);
  border-bottom: 1px solid rgba(245, 158, 11, 0.35);
  backdrop-filter: blur(6px);
  box-shadow: 0 6px 16px rgba(15, 23, 42, 0.08);
}

.demo-cta-inner {
  max-width: 980px;
  margin: 0 auto;
  padding: 8px 24px;
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 12px;
  justify-content: space-between;
}

.demo-cta-actions {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  align-items: center;
}

button[disabled],
.btn[disabled] {
  opacity: 0.45;
  cursor: not-allowed;
  box-shadow: none;
}

@media (max-width: 720px) {
  .demo-disclaimer .demo-disclaimer-inner {
    padding: 10px 16px;
  }

  body {
    min-height: 100svh;
    min-height: 100dvh;
  }

  .app.chat-app {
    height: auto;
    min-height: 100svh;
    min-height: 100dvh;
    overflow: auto;
  }

  .demo-app.chat-app {
    height: auto;
    min-height: calc(100svh - var(--demo-disclaimer-height) - var(--demo-cta-height));
    min-height: calc(100dvh - var(--demo-disclaimer-height) - var(--demo-cta-height));
  }

}

    .demo-embed-mode,
    .demo-embed-mode body {
      overscroll-behavior: contain;
    }
    </style>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7932116761740840" crossorigin="anonymous"></script>
</head>
  <body>
    <div class="demo-disclaimer" role="note" aria-label="誤解防止の注意事項">
      <div class="demo-disclaimer-inner">
        <div><strong>これはブラウザ上のデモです。</strong> 実際のファイル変更・OpenAI Codexの実行は行いません。</div>
        <div>本番はWindows βアプリで、ログイン→準備が自動→日本語UI一本道で作成できます。</div>
        <div>本製品はOpenAI等の公式製品ではありません。</div>
      </div>
    </div>

    <div class="demo-cta" role="region" aria-label="次のアクション">
      <div class="demo-cta-inner">
        <span class="micro">デモを試したら、次へ進んでください。</span>
        <div class="demo-cta-actions">
          <a class="btn ghost small" href="/p/ichime-ai/">製品LP</a>
          <a class="btn ghost small" data-stripe="buy" href="https://buy.stripe.com/cNicN59Tk84Ee6M8A414401" target="_blank" rel="noopener noreferrer">購入</a>
          <a class="btn primary small" href="/start">次へ：はじめる</a>
        </div>
      </div>
    </div>

    <div class="app demo-app" id="demoApp">
      <div class="demo-start-flow" id="demoStartFlow">
      <header class="hero start-flow-hero">
        <div>
          <h1>イチメAI（日本語AIコーディング入門）</h1>
        </div>
        <div class="start-flow-actions">
          <div class="status-badge status-connected" id="demoConnectionBadge">
            <span class="status-dot"></span>
            <span id="demoConnectionLabel">接続済み</span>
          </div>
          <div class="start-flow-menu">
            <button
              class="btn ghost small settings-btn"
              type="button"
              aria-label="メニュー"
              aria-haspopup="menu"
              aria-expanded="false"
              id="demoMenuButton"
            >
              ...
            </button>
            <div class="start-flow-menu-panel demo-hidden" role="menu" id="demoMenu">
              <button class="start-flow-menu-item demo-frozen" type="button" role="menuitem" data-action="menu-login" data-frozen="true" aria-disabled="true" disabled>
                ログイン
              </button>
              <button class="start-flow-menu-item demo-frozen" type="button" role="menuitem" data-action="menu-connect" data-frozen="true" aria-disabled="true" disabled>
                接続を確認
              </button>
              <button class="start-flow-menu-item demo-frozen" type="button" role="menuitem" data-action="menu-settings" data-frozen="true" aria-disabled="true" disabled>
                設定
              </button>
            </div>
          </div>
        </div>
      </header>

      <main class="stack">
        <section class="card start-flow-card">
          <div class="card-header" id="demoCardHeader">
            <h2 id="demoCardTitle"></h2>
          </div>
          <div id="demoBody"></div>
        </section>
      </main>
      </div>
      <div class="demo-work-flow demo-hidden" id="demoWorkFlow">
        <aside class="sidebar" aria-label="セッション一覧（デスクトップ）">
          <div class="sidebar-inner">
            <div class="sbTop">
              <div class="brand">
                <div class="logo">CC</div>
                <div class="brandText">
                  <div class="name">イチメAI デモ</div>
                </div>
              </div>
              <button class="btn small ghost demo-frozen" type="button" aria-label="ホームに戻る" disabled>
                ホーム
              </button>
            </div>
            <div class="sbBtns">
              <button class="btn primary demo-frozen" type="button" disabled>＋ 新しいセッション</button>
              <button class="btn demo-frozen" type="button" disabled>再読み込み</button>
            </div>
            <div class="sbSearch">
              <label class="sr" for="demo-session-search">検索</label>
              <input id="demo-session-search" placeholder="セッションを検索" disabled />
            </div>
            <div class="sbSection">
              <h3>セッション</h3>
              <span class="sbCount">1</span>
            </div>
            <div class="sessionList">
              <div class="session active">
                <div class="meta">
                  <p class="title" title="はじめてのチャット">はじめてのチャット</p>
                  <div class="meta-line">
                    <span class="mode">作業</span>
                    <span class="meta-sep">·</span>
                    <span class="time">今日 10:24</span>
                  </div>
                </div>
                <div class="session-actions">
                  <button class="session-menu-button demo-frozen" type="button" aria-label="セッションメニュー" disabled>
                    …
                  </button>
                </div>
              </div>
              <div class="session demo-frozen" aria-disabled="true">
                <div class="meta">
                  <p class="title" title="過去のセッション">過去のセッション</p>
                  <div class="meta-line">
                    <span class="mode">通常</span>
                    <span class="meta-sep">·</span>
                    <span class="time">昨日</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="sbBottom">
              <div class="sbUsage">
                <div class="sbUsageTop">
                  <span class="sbUsageTitle">デモプラン</span>
                  <span class="sbUsagePlan">テスト</span>
                </div>
                <div class="sbUsageRow">
                  <span class="sbUsageLabel">5h 残量</span>
                  <span class="sbUsageValue">70%</span>
                </div>
                <div class="sbUsageRow">
                  <span class="sbUsageLabel">5h リセット</span>
                  <span class="sbUsageValue">今日 18:30</span>
                </div>
                <div class="sbUsageBar is-primary">
                  <div class="sbUsageFill" style="width: 70%"></div>
                </div>
                <div class="sbUsageRow">
                  <span class="sbUsageLabel">週 残量</span>
                  <span class="sbUsageValue">42%</span>
                </div>
                <div class="sbUsageRow">
                  <span class="sbUsageLabel">週 リセット</span>
                  <span class="sbUsageValue">02/02 09:00</span>
                </div>
                <div class="sbUsageBar is-secondary">
                  <div class="sbUsageFill" style="width: 42%"></div>
                </div>
                <div class="sbUsageNote">更新済み</div>
              </div>
            </div>
          </div>
        </aside>
        <main class="main" aria-label="チャット">
          <div class="topbar">
            <div class="topLeft">
              <div class="crumb" title="プロジェクト / セッション">
                <div class="project">自己紹介ページ</div>
                <div class="sep">/</div>
                <div class="sessionName">はじめてのチャット</div>
              </div>
              <div class="modelMenu">
                <button class="modelBtn demo-frozen" type="button" aria-haspopup="dialog" aria-expanded="false" disabled>
                  <div class="label">
                    <strong>gpt-codex-5.2</strong>
                    <span>推論: 標準</span>
                  </div>
                  <span aria-hidden="true">▾</span>
                </button>
                <div class="popover" role="dialog">
                  <div class="popHead">
                    <strong>モデル / 推論</strong>
                    <div class="popActions">
                      <button class="btn small ghost demo-frozen" type="button" disabled>再読み込み</button>
                      <button class="btn small demo-frozen" type="button" disabled>閉じる</button>
                    </div>
                  </div>
                  <div class="popBody">
                    <div class="popSection">
                      <div class="popRecommend">
                        <div class="opt rec active">
                          <div>
                            <div class="t">
                              品質優先
                              <span class="optBadge">選択中</span>
                            </div>
                            <div class="modelId">gpt-codex-5.2</div>
                            <div class="d">しっかり作りたいとき（品質重視）</div>
                          </div>
                        </div>
                        <div class="opt rec">
                          <div>
                            <div class="t">速い・節約</div>
                            <div class="modelId">gpt-codex-5.2 mini</div>
                            <div class="d">まず試す／軽い相談や小さな修正に</div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <details class="popAdvanced">
                      <summary>
                        <span>その他のモデル（2）</span>
                        <span class="caret" aria-hidden="true">▾</span>
                      </summary>
                      <div class="popAdvancedBody">
                        <button class="opt active" type="button" aria-pressed="true" disabled>
                          <div>
                            <div class="t">
                              gpt-codex-5.2
                              <span class="optBadge">選択中</span>
                            </div>
                            <div class="d">高精度（おすすめ）</div>
                          </div>
                        </button>
                        <button class="opt" type="button" aria-pressed="false" disabled>
                          <div>
                            <div class="t">gpt-codex-5.2 mini</div>
                            <div class="d">推奨候補</div>
                          </div>
                        </button>
                      </div>
                    </details>
                    <div class="divider"></div>
                    <div
                      class="popLabel tip"
                      title="推論の深さが高ければ高いほど詳しく考えてくれますが、使用量の消費は増えます。"
                    >
                      推論の深さ
                    </div>
                    <div class="seg" role="group" aria-label="推論の深さ">
                      <button class="active" type="button" disabled>
                        <span class="segTitle">
                          標準
                          <span class="segBadge">おすすめ</span>
                        </span>
                        <small>バランス重視</small>
                      </button>
                      <button type="button" disabled>
                        <span class="segTitle">高</span>
                        <small>しっかり考える</small>
                      </button>
                      <button type="button" disabled>
                        <span class="segTitle">低</span>
                        <small>軽く速い</small>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="topRight">
              <div class="launchBlock">
                <button
                  class="btn primary small demo-next-action"
                  type="button"
                  data-action="open-preview"
                  id="demoLaunchPreviewBtn"
                >
                  起動（プレビュー）
                </button>
                <button class="btn ghost small demo-frozen" type="button" disabled>
                  設定
                  <span class="settings-update-dot" aria-hidden="true"></span>
                </button>
              </div>
            </div>
          </div>
          <div class="demo-work-panel demo-work-panel-planner" id="demoPlannerPanel">
            <section class="chat" aria-label="相談">
              <div class="messages" id="demoPlannerMessages">
                <div class="centerCol" id="demoPlannerMessagesInner">
                  <div class="day">今日</div>
                  <div class="demo-planner-card demo-hidden" id="demoPlannerCard">
                    <section class="card">
                      <div class="card-header">
                        <h2>5. 相談 (Planner)</h2>
                        <span class="micro">回答は「作る内容メモ」に保存</span>
                      </div>
                      <p class="micro">相談内容は「作る内容メモ」に保存されます。</p>
                      <p class="micro">未入力は「未記入」として保存します。</p>
                      <div class="planner-grid">
                        <div class="planner-question">
                          <label class="label">1) 何を作りたい？</label>
                          <p class="micro">形式を決めると迷いが減ります。</p>
                          <textarea class="textarea planner-textarea" rows="3" disabled>タスク管理アプリ（Webアプリ）</textarea>
                          <div class="planner-suggestions">
                            <button class="planner-suggestion is-recommended" type="button" disabled>おすすめ: Webアプリ（ブラウザで動くもの）</button>
                            <button class="planner-suggestion" type="button" disabled>デスクトップツール</button>
                          </div>
                        </div>
                        <div class="planner-question">
                          <label class="label">2) できたら完成と言える条件（最大3つ）</label>
                          <p class="micro">達成条件を短く書きます。</p>
                          <textarea class="textarea planner-textarea" rows="3" disabled>入力→出力が1往復できる\n主要画面が1つ完成</textarea>
                          <div class="planner-suggestions">
                            <button class="planner-suggestion is-recommended" type="button" disabled>おすすめ: 入力→出力が1往復できる</button>
                            <button class="planner-suggestion" type="button" disabled>3回連続で動作</button>
                          </div>
                        </div>
                        <div class="planner-question">
                          <label class="label">3) 使う人</label>
                          <p class="micro">対象ユーザーを決めます。</p>
                          <textarea class="textarea planner-textarea" rows="3" disabled>自分だけ</textarea>
                          <div class="planner-suggestions">
                            <button class="planner-suggestion is-recommended" type="button" disabled>おすすめ: 自分だけ</button>
                            <button class="planner-suggestion" type="button" disabled>チーム内</button>
                          </div>
                        </div>
                        <div class="planner-question">
                          <label class="label">4) 必須機能（最大3つ）</label>
                          <p class="micro">絶対に外せない機能だけ書きます。</p>
                          <textarea class="textarea planner-textarea" rows="3" disabled>追加\n完了\n削除</textarea>
                          <div class="planner-suggestions">
                            <button class="planner-suggestion is-recommended" type="button" disabled>おすすめ: 入力フォーム + 結果表示</button>
                            <button class="planner-suggestion" type="button" disabled>保存・履歴</button>
                          </div>
                        </div>
                        <div class="planner-question">
                          <label class="label">5) やらないこと（1つ）</label>
                          <p class="micro">後回しにする項目を書きます。</p>
                          <textarea class="textarea planner-textarea" rows="3" disabled>課金対応はしない</textarea>
                          <div class="planner-suggestions">
                            <button class="planner-suggestion is-recommended" type="button" disabled>おすすめ: スマホ対応は後回し</button>
                            <button class="planner-suggestion" type="button" disabled>多言語対応はしない</button>
                          </div>
                        </div>
                        <div class="planner-question">
                          <label class="label">6) 制約（期限/予算/対応端末など）</label>
                          <p class="micro">現実的な制約を先に決めます。</p>
                          <textarea class="textarea planner-textarea" rows="3" disabled>期限: 1週間\n対応端末: PCのみ</textarea>
                          <div class="planner-suggestions">
                            <button class="planner-suggestion is-recommended" type="button" disabled>おすすめ: 期限は1週間</button>
                            <button class="planner-suggestion" type="button" disabled>予算: 0円</button>
                          </div>
                        </div>
                      </div>
                      <div class="planner-actions">
                        <button class="btn primary emphasis" type="button" data-action="planner-save">作る内容メモを保存</button>
                        <button class="btn ghost" type="button" disabled>クリア</button>
                      </div>
                      <p class="micro">保存しました。要件がまとまりました。</p>
                    </section>
                  </div>
                </div>
              </div>
            </section>
            <div class="composer" aria-label="相談入力欄">
              <p class="micro attachmentHint">
                添付したファイルはこのプロジェクトに保存され、OpenAI Codexが読めるようになります。
              </p>
              <div class="plannerQuick">
                <button class="btn small primary" type="button">のこりは全部おまかせで</button>
                <button class="btn ghost small" type="button">決まった要件定義を表示する</button>
              </div>
              <div class="composerQuick">
                <button class="btn ghost small" type="button">次に何をすればいい？</button>
                <button class="btn ghost small" type="button">うまく動かない</button>
              </div>
              <div class="composerInner">
                <input class="fileInput" type="file" multiple />
                <textarea
                  id="demoPlannerInput"
                  placeholder="相談内容を入力…"
                ></textarea>
                <div class="composerActions">
                  <button class="btn icon ghost" type="button" aria-label="ファイルを添付">
                    🖇️
                  </button>
                  <div class="attachmentCounter" aria-live="polite">添付なし</div>
                  <button class="btn primary" type="button">送信</button>
                </div>
              </div>
              <div class="hint">
                <div>
                  <span class="kbd">Enter</span> 送信 / <span class="kbd">Shift</span>+<span class="kbd">Enter</span> 改行
                </div>
              </div>
            </div>
          </div>
          <div class="demo-work-panel demo-work-panel-builder" id="demoBuilderPanel">
            <section class="chat" aria-label="会話">
              <div class="messages" id="demoMessages" data-scroll-capture="messages">
                <div class="centerCol" id="demoMessagesInner">
                  <div class="day">今日</div>
                </div>
              </div>
            </section>
            <div class="composer" aria-label="入力欄">
              <p class="micro attachmentHint">
                添付したファイルはこのプロジェクトに保存され、OpenAI Codexが読めるようになります。
              </p>
              <div class="composerQuick">
                <button class="btn ghost small" type="button">次に何をすればいい？</button>
                <button class="btn ghost small" type="button">うまく動かない</button>
              </div>
              <div class="composerInner">
                <input class="fileInput" type="file" multiple />
                <textarea
                  id="demoComposerInput"
                  placeholder="メッセージを入力…（Enterで送信 / Shift+Enterで改行）"
                ></textarea>
                <div class="composerActions">
                  <button class="btn icon ghost" type="button" aria-label="ファイルを添付">
                    🖇️
                  </button>
                  <div class="attachmentCounter" aria-live="polite">添付なし</div>
                  <button class="btn primary" type="button">送信</button>
                </div>
              </div>
              <div class="hint">
                <div>
                  <span class="kbd">Enter</span> 送信 / <span class="kbd">Shift</span>+<span class="kbd">Enter</span> 改行
                </div>
              </div>
            </div>
          </div>
        </main>
        <div class="demo-preview-overlay" id="demoPreviewOverlay" aria-hidden="true">
          <div class="demo-preview-shell" role="dialog" aria-label="プレビュー">
            <div class="demo-preview-header">
              <div class="demo-preview-title">プレビュー</div>
              <button
                class="btn ghost small"
                type="button"
                data-action="close-preview"
                id="demoPreviewClose"
              >
                閉じる
              </button>
            </div>
            <div class="demo-preview-body">
              <iframe id="demoPreviewFrame" title="UIサンプルプレビュー"></iframe>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="demo-cursor" id="demoCursor" aria-hidden="true"></div>
    <div class="demo-cursor-ring" id="demoCursorRing" aria-hidden="true"></div>
    <script>
      const SITE_CONFIG = window.SITE_CONFIG || {};
      const DEMO_EMBED = (() => {
        try {
          const params = new URLSearchParams(window.location.search);
          return params.get("embed") === "1" || window.self !== window.top;
        } catch (error) {
          return false;
        }
      })();
      if (DEMO_EMBED) {
        document.documentElement.classList.add("demo-embed-mode");
      }
      const APP_NAME = SITE_CONFIG.PRODUCT_NAME_SHORT || SITE_CONFIG.APP_NAME || "イチメAI";
      const START_URL = SITE_CONFIG.START_URL || "/start";
      const TRACK_ENDPOINT = "";
      const AUTO_FLOW = true;

      const demoApp = document.getElementById("demoApp");
      const demoStartFlow = document.getElementById("demoStartFlow");
      const demoWorkFlow = document.getElementById("demoWorkFlow");
      const demoBody = document.getElementById("demoBody");
      const demoCardHeader = document.getElementById("demoCardHeader");
      const demoCardTitle = document.getElementById("demoCardTitle");
      const demoMenuButton = document.getElementById("demoMenuButton");
      const demoMenu = document.getElementById("demoMenu");
      const demoConnectionBadge = document.getElementById("demoConnectionBadge");
      const demoConnectionLabel = document.getElementById("demoConnectionLabel");
      const demoMessages = document.getElementById("demoMessages");
      const demoMessagesInner = document.getElementById("demoMessagesInner");
      const demoComposerInput = document.getElementById("demoComposerInput");
      const demoCursor = document.getElementById("demoCursor");
      const demoCursorRing = document.getElementById("demoCursorRing");
      const demoDisclaimer = document.querySelector(".demo-disclaimer");
      const demoCta = document.querySelector(".demo-cta");
      const demoPlannerPanel = document.getElementById("demoPlannerPanel");
      const demoBuilderPanel = document.getElementById("demoBuilderPanel");
      const demoPlannerMessages = document.getElementById("demoPlannerMessages");
      const demoPlannerMessagesInner = document.getElementById("demoPlannerMessagesInner");
      const demoPlannerCard = document.getElementById("demoPlannerCard");
      const demoPlannerInput = document.getElementById("demoPlannerInput");
      const demoLaunchPreviewBtn = document.getElementById("demoLaunchPreviewBtn");
      const demoPreviewOverlay = document.getElementById("demoPreviewOverlay");
      const demoPreviewClose = document.getElementById("demoPreviewClose");
      const demoPreviewFrame = document.getElementById("demoPreviewFrame");
      const plannerQuickTemplate = demoPlannerPanel?.querySelector(".plannerQuick");

      const clonePlannerQuick = () => {
        if (!plannerQuickTemplate) return null;
        return plannerQuickTemplate.cloneNode(true);
      };

      const updateHeaderHeights = () => {
        const disclaimerHeight = demoDisclaimer ? demoDisclaimer.offsetHeight : 0;
        const ctaHeight = demoCta ? demoCta.offsetHeight : 0;
        document.documentElement.style.setProperty("--demo-disclaimer-height", `${disclaimerHeight}px`);
        document.documentElement.style.setProperty("--demo-cta-height", `${ctaHeight}px`);
      };

      updateHeaderHeights();
      window.addEventListener("resize", updateHeaderHeights);

      const scrollWithinContainer = (container, target, mode = "end") => {
        if (!container) return;
        if (mode === "center" && target) {
          const top = target.offsetTop - container.clientHeight / 2;
          container.scrollTop = Math.max(0, top);
          return;
        }
        container.scrollTop = container.scrollHeight;
      };

      const scrollIntoViewSafe = (target, options = {}) => {
        if (!target) return;
        if (DEMO_EMBED) {
          const container =
            target.closest(".messages") ||
            (target === demoMessagesInner ? demoMessages : demoPlannerMessages);
          const mode = options.block === "center" ? "center" : "end";
          scrollWithinContainer(container, target, mode);
          return;
        }
        target.scrollIntoView(options);
      };

      const storageKeys = {
        session: "demoSessionId",
        events: "demoEvents",
      };

      const getSessionId = () => {
        let id = localStorage.getItem(storageKeys.session);
        if (!id) {
          id = `demo-${crypto.randomUUID ? crypto.randomUUID() : Math.random().toString(36).slice(2)}`;
          localStorage.setItem(storageKeys.session, id);
        }
        return id;
      };

      const sessionId = getSessionId();

      const normalizePayload = (payload = {}) => {
        const sanitized = {};
        Object.entries(payload).forEach(([key, value]) => {
          if (value === undefined || value === null) return;
          if (typeof value === "string" || typeof value === "number" || typeof value === "boolean") {
            sanitized[key] = value;
          } else {
            sanitized[key] = JSON.stringify(value);
          }
        });
        return sanitized;
      };

      const sendToGA = (eventName, payload = {}) => {
        if (typeof window.gtag !== "function") return;
        const params = normalizePayload(payload);
        window.gtag("event", eventName, {
          ...params,
          session_id: sessionId,
          event_category: "demo",
          transport_type: "beacon",
        });
      };

      const track = (eventName, payload = {}) => {
        const event = {
          sessionId,
          name: eventName,
          payload,
          timestamp: new Date().toISOString(),
        };
        let list = [];
        try {
          const raw = localStorage.getItem(storageKeys.events);
          list = raw ? JSON.parse(raw) : [];
        } catch {
          list = [];
        }
        list.push(event);
        localStorage.setItem(storageKeys.events, JSON.stringify(list));
        console.log("[demo-track]", event);
        if (TRACK_ENDPOINT) {
          try {
            navigator.sendBeacon(TRACK_ENDPOINT, JSON.stringify(event));
          } catch {
            // no-op
          }
        }
        sendToGA(eventName, payload);
      };

      const viewTitles = {
        connect: "PCに接続する",
        login: "ログイン",
        home: "",
        new: "",
        work: "",
        running: "準備中",
        preview: "プレビュー",
        complete: "次へ：はじめる",
        continue: "続きを開く",
        settings: "設定",
      };

      const stepIndex = {
        home: 0,
        new: 1,
        work: 2,
        running: 2,
        preview: 3,
        complete: 4,
        connect: 0,
        login: 1,
        continue: 2,
        settings: 2,
      };

      const PREVIEW_URL = "universal-starter/index.html?embed=1";

      let currentView = "login";
      let demoStarted = false;
      let progressTimer = null;
      let progressValue = 0;
      let autoFlowTimer = null;
      let autoFlowIndex = 0;
      let autoFlowActive = false;
      let workMode = "planner";
      let plannerTimer = null;
      let plannerAutofillTimer = null;
      let plannerSummaryShown = false;
      let plannerAutofillDone = false;
      let workActionsBound = false;
      let plannerChatTimer = null;
      let plannerChatIndex = 0;
      let plannerChatStarted = false;
      let zoomTimer = null;
      let previewOpened = false;
      let previewCloseTimer = null;
      let previewOpenTimer = null;
      let demoPaused = false;
      let plannerChatContinue = null;
      let chatDemoContinue = null;

      const AUTO_FLOW_STEPS = [
        { view: "login", delay: 1200 },
        { view: "home", delay: 1200 },
        { view: "new", delay: 1400 },
        { view: "work", delay: 0 },
      ];

      let chatDemoStarted = false;
      let chatDemoIndex = 0;
      let chatDemoTimer = null;
      let typingTimer = null;
      let cursorTimer = null;
      const CHAT_STEPS = [
        { role: "user", text: "この内容でOK。作業を進めて。" },
        {
          role: "assistant",
          text: "了解しました。作業を開始します。まず一覧画面を作成します。",
          working: true,
          logs: "[file_change] apps/client/src/App.tsx\n[file_change] apps/client/src/styles.css",
        },
        { role: "user", text: "一覧は大きめのボタンで、わかりやすく。" },
        {
          role: "assistant",
          text: "一覧と追加フォームを配置しました。次に完了チェックを追加します。",
          logs: "[file_change] apps/client/src/components/TaskList.tsx",
        },
        { role: "user", text: "完了チェックはトグル形式にして。" },
        {
          role: "assistant",
          text: "完了トグルと削除ボタンを追加しました。確認しましょう。",
          logs: "動作確認: PASS",
        },
        { role: "user", text: "動作確認OK。次はデザインを少し整えて。" },
        {
          role: "assistant",
          text: "",
          builderComplete: true,
        },
        { role: "user", text: "次はダークモード対応も検討して。" },
      ];

      const PLANNER_CHAT_STEPS = [
        { role: "user", text: "タスク管理アプリを作りたい。" },
        { role: "assistant", text: "了解しました。まずは相談で要件を整理します。" },
        { role: "user", text: "Webアプリで、シンプルにまとめたい。" },
        { role: "assistant", text: "OKです。フォームで要件を埋めていきます。" },
      ];

      const ensureDemoStarted = () => {
        if (!demoStarted) {
          demoStarted = true;
          track("demo_start");
        }
      };

      const setView = (view) => {
        currentView = view;
        track("step_view", { step: stepIndex[view] ?? view, view });
        if (view === "connect") {
          updateConnectionStatus("connecting");
        } else if (
          view === "login" ||
          view === "home" ||
          view === "new" ||
          view === "running" ||
          view === "preview" ||
          view === "complete"
        ) {
          updateConnectionStatus("connected");
        }
        if (view === "work") {
          autoFlowActive = false;
        }
        if (view === "complete") {
          track("demo_complete");
        }
        render();
        focusCursorForView();
        if (AUTO_FLOW && autoFlowActive) {
          if (view === "preview") {
            clearTimeout(autoFlowTimer);
            autoFlowTimer = setTimeout(() => setView("complete"), 1500);
          } else if (view === "complete") {
            autoFlowActive = false;
          }
        }
      };

      const viewTemplates = {
        connect: () => `
          <h3 class="start-flow-title">PCに接続する</h3>
          <p class="start-flow-text">PC側でHostを起動したら「PCに接続する」を押してください。</p>
          <button class="btn primary start-flow-primary demo-frozen" type="button" data-action="connect" data-frozen="true" aria-disabled="true" disabled>
            PCに接続する
          </button>
          <p class="hint" id="demoConnectHint">デモのため接続は即完了します。</p>
          <div class="start-flow-options"></div>
        `,
        login: () => `
          <h3 class="start-flow-title">ログイン</h3>
          <div class="row start-flow-status">
            <span class="chip chip-ok">ログイン済み</span>
            <span class="micro">デモモード</span>
          </div>
          <p class="start-flow-text">ログイン済みの想定で進めます。</p>
          <div class="start-flow-login">
            <button class="btn primary" type="button" data-action="login-continue">ログイン</button>
            <div class="row">
              <button class="btn ghost small demo-frozen" type="button" data-action="login-refresh" data-frozen="true" aria-disabled="true" disabled>状態更新</button>
            </div>
            <p class="micro">ログインが完了したら「状態更新」で進めます。</p>
          </div>
        `,
        home: () => `
          <div class="start-choice-grid">
            <button class="start-choice-card is-recommended" type="button" data-action="go-new">
              <div class="start-choice-header">
                <span class="start-choice-title">新しく作る</span>
                <span class="pill pill-ok">おすすめ</span>
              </div>
              <p class="start-choice-sub">テンプレを選んで、すぐ作り始めます</p>
            </button>
            <button class="start-choice-card demo-frozen" type="button" data-action="go-continue" data-frozen="true" aria-disabled="true" disabled>
              <div class="start-choice-header">
                <span class="start-choice-title">続きを開く</span>
              </div>
              <p class="start-choice-sub">前回のプロジェクトを続けます</p>
              <p class="start-choice-latest">前回：自己紹介ページ</p>
            </button>
          </div>
        `,
        continue: () => `
          <div class="project-highlight-card demo-frozen" aria-disabled="true">
            <div>
              <span class="project-highlight-label">前回の続き</span>
              <div class="project-highlight-title">自己紹介ページ</div>
              <div class="micro">最終更新: 今日</div>
            </div>
            <button class="btn primary demo-frozen" type="button" data-action="open-project" data-frozen="true" aria-disabled="true" disabled>開く</button>
          </div>
          <div class="project-list-toolbar demo-frozen" aria-disabled="true">
            <div class="project-search">
              <label class="label" for="demo-project-search">プロジェクト名で検索</label>
              <input id="demo-project-search" class="input" value="" placeholder="プロジェクト名で検索" />
            </div>
            <button class="btn demo-frozen" type="button" data-action="go-new" data-frozen="true" aria-disabled="true" disabled>新しく作る</button>
            <button class="btn demo-frozen" type="button" data-action="go-home" data-frozen="true" aria-disabled="true" disabled>ホームへ戻る</button>
          </div>
          <div class="start-flow-list">
            <div class="start-flow-row">
              <div class="start-flow-row-main">
                <span class="start-flow-row-title">自己紹介ページ</span>
                <span class="micro">最終更新: 今日</span>
              </div>
              <div class="project-row-actions">
                <button class="btn demo-frozen" type="button" data-action="open-project" data-frozen="true" aria-disabled="true" disabled>開く</button>
              </div>
            </div>
          </div>
        `,
        new: () => `
          <div class="start-flow-header">
            <span class="start-flow-kicker">新しく作る</span>
            <h3 class="start-flow-title">プロジェクトを作成</h3>
            <p class="start-flow-text">おすすめで一気に作るか、必要なら詳細を選んで作成できます。</p>
          </div>
          <div class="start-flow-block">
            <label class="field-label" for="demo-project-name">プロジェクト名 <span class="field-required">必須</span></label>
            <input id="demo-project-name" class="input" value="自己紹介ページ" />
            <p class="micro">あとで変更できます。</p>
            <p class="micro start-flow-meta">
              <span class="meta-label">保存先</span>
              <span class="meta-value">
                <button class="project-folder-link" type="button" data-action="open-folder" title="C:\\Users\\user\\IchimeAI Demo Projects">
                  プロジェクトフォルダ
                </button>
              </span>
            </p>
          </div>
          <div class="start-flow-recommend">
            <div class="row start-flow-cta-row">
              <button class="btn primary start-flow-primary" type="button" data-action="create-project">
                おすすめで作成（1クリック）
              </button>
            </div>
            <p class="micro">おすすめのテンプレ・見た目・レイアウトで始めます。</p>
          </div>
          <div class="start-flow-block demo-frozen" aria-disabled="true">
            <div class="project-highlight-card">
              <div>
                <span class="project-highlight-label">続きから（デモでは無効）</span>
                <div class="project-highlight-title">前回のプロジェクト</div>
                <div class="micro">続きからはデモでは利用できません。</div>
              </div>
              <button class="btn primary demo-frozen" type="button" disabled>開く</button>
            </div>
          </div>
          <details class="start-flow-details">
            <summary>詳細を選ぶ（テンプレ / 見た目 / レイアウト）</summary>
            <div class="start-flow-details-body">
              <div class="start-flow-block">
                <h4 class="start-flow-subtitle">サンプルUI</h4>
                <div class="start-flow-grid">
                  <button class="start-flow-choice is-selected" type="button">
                    <div class="start-flow-choice-header">
                      <span class="start-flow-choice-title">自己紹介ページ</span>
                      <span class="pill pill-ok">おすすめ</span>
                    </div>
                    <p class="micro">シンプルなプロフィール構成</p>
                  </button>
                  <button class="start-flow-choice" type="button">
                    <div class="start-flow-choice-header">
                      <span class="start-flow-choice-title">ポートフォリオ</span>
                    </div>
                    <p class="micro">実績を見せる構成</p>
                  </button>
                </div>
              </div>
              <div class="start-flow-block">
                <h4 class="start-flow-subtitle">見た目スタイル</h4>
                <div class="start-flow-grid">
                  <button class="start-flow-choice is-selected" type="button">
                    <div class="start-flow-choice-header">
                      <span class="start-flow-choice-title">やさしい</span>
                      <span class="pill pill-ok">おすすめ</span>
                    </div>
                    <p class="micro">柔らかい配色と余白</p>
                  </button>
                  <button class="start-flow-choice" type="button">
                    <div class="start-flow-choice-header">
                      <span class="start-flow-choice-title">ミニマル</span>
                    </div>
                    <p class="micro">情報を整理して表示</p>
                  </button>
                </div>
              </div>
              <div class="start-flow-block">
                <h4 class="start-flow-subtitle">UIサンプル（プレビュー）</h4>
                <div class="ui-template-preview">
                  <div class="ui-template-preview-header">
                    <span class="ui-template-preview-title">プレビュー</span>
                    <span class="pill pill-ok">テーマ: Warm</span>
                  </div>
                  <div class="ui-template-preview-frame">
                    <iframe title="UIサンプルプレビュー" src="${PREVIEW_URL}"></iframe>
                  </div>
                </div>
              </div>
            </div>
          </details>
          <div class="row">
            <button class="btn demo-frozen" type="button" data-action="go-home" data-frozen="true" aria-disabled="true" disabled>ホームへ戻る</button>
          </div>
        `,
        running: () => `
          <div class="start-flow-boot">
            <div class="workingIndicator">
              <span class="spinner" aria-hidden></span>
              作成中...
            </div>
            <div class="demo-progress" aria-hidden="true">
              <span id="demoProgressBar"></span>
            </div>
            <div class="row start-flow-status">
              <span class="chip chip-connecting">進行中</span>
              <span class="micro" id="demoProgressLabel">進捗 0%</span>
            </div>
            <div class="demo-log">
              <div class="output-panel"><pre id="demoLog">テンプレを展開中...</pre></div>
            </div>
          </div>
        `,
        preview: () => `
          <div class="start-flow-block">
            <h4 class="start-flow-subtitle">プレビュー</h4>
            <div class="ui-template-preview">
              <div class="ui-template-preview-header">
                <span class="ui-template-preview-title">プレビュー</span>
                <span class="pill pill-ok">デモ</span>
              </div>
              <div class="ui-template-preview-frame">
                <iframe title="デモプレビュー" src="${PREVIEW_URL}"></iframe>
              </div>
            </div>
            <div class="row start-flow-cta-row" style="margin-top: 16px;">
              <button class="btn primary start-flow-primary" type="button" data-action="complete">完了</button>
            </div>
          </div>
        `,
        complete: () => `
            <div class="start-flow-block">
              <h3 class="start-flow-title">デモ完了</h3>
              <p class="start-flow-text">デモはここまでです。次の一手を開始ページにまとめました。</p>
              <button class="btn primary start-flow-primary" type="button" data-action="final-cta">次へ：はじめる</button>
              <p class="micro">${APP_NAME} の購入・配布枠・案内をまとめています。</p>
            </div>
          `,
        settings: () => `
          <div class="start-flow-alert" role="alert">
            <div class="start-flow-alert-title">設定（デモ）</div>
            <p class="start-flow-alert-body">本体の設定画面と同じ導線を示すためのダミー表示です。</p>
            <div class="row">
              <button class="btn ghost small" type="button" data-action="go-home">ホームへ戻る</button>
            </div>
          </div>
        `,
      };

      const updateHeader = () => {
        const title = viewTitles[currentView] || "";
        if (demoCardHeader && demoCardTitle) {
          if (title) {
            demoCardHeader.classList.remove("demo-hidden");
            demoCardTitle.textContent = title;
          } else {
            demoCardHeader.classList.add("demo-hidden");
            demoCardTitle.textContent = "";
          }
        }
      };

      const updateConnectionStatus = (state) => {
        demoConnectionBadge.classList.remove("status-connected", "status-connecting", "status-error");
        demoConnectionBadge.classList.add(`status-${state}`);
        demoConnectionLabel.textContent =
          state === "connected" ? "接続済み" : state === "connecting" ? "接続中" : "未接続";
      };

      const clearDemoTimers = () => {
        clearTimeout(autoFlowTimer);
        clearTimeout(plannerTimer);
        clearTimeout(plannerAutofillTimer);
        clearTimeout(plannerChatTimer);
        clearTimeout(chatDemoTimer);
        clearTimeout(zoomTimer);
        clearTimeout(cursorTimer);
        clearTimeout(previewOpenTimer);
        clearInterval(typingTimer);
        clearInterval(progressTimer);
      };

      const updateDemoControls = () => {
        const pauseBtn = document.getElementById("demoPauseBtn");
        const resumeBtn = document.getElementById("demoResumeBtn");
        if (pauseBtn) pauseBtn.disabled = demoPaused;
        if (resumeBtn) resumeBtn.disabled = !demoPaused;
      };

      const pauseDemo = () => {
        if (demoPaused) return;
        demoPaused = true;
        clearDemoTimers();
        updateDemoControls();
      };

      const resumeDemo = () => {
        if (!demoPaused) return;
        demoPaused = false;
        updateDemoControls();
        if (currentView === "running" && progressValue < 100) {
          startProgress(true);
          return;
        }
        if (currentView === "work") {
          if (workMode === "planner" && plannerChatContinue) {
            plannerChatContinue();
            return;
          }
          if (workMode === "builder" && chatDemoContinue) {
            chatDemoContinue();
            return;
          }
        }
        if (AUTO_FLOW && autoFlowActive) {
          scheduleAutoStep();
        }
      };

      const moveCursorTo = (element) => {
        if (!demoCursor || !element) return;
        const rect = element.getBoundingClientRect();
        const x = rect.left + rect.width * 0.6;
        const y = rect.top + rect.height * 0.6;
        demoCursor.style.left = `${x}px`;
        demoCursor.style.top = `${y}px`;
        if (demoCursorRing) {
          demoCursorRing.style.left = `${x}px`;
          demoCursorRing.style.top = `${y}px`;
          demoCursorRing.classList.add("is-visible");
          clearTimeout(cursorTimer);
          cursorTimer = setTimeout(() => {
            demoCursorRing.classList.remove("is-visible");
          }, 500);
        }
      };

      const clickCursor = () => {
        if (!demoCursor) return;
        demoCursor.classList.add("is-clicking");
        clearTimeout(cursorTimer);
        cursorTimer = setTimeout(() => {
          demoCursor.classList.remove("is-clicking");
        }, 220);
      };

      const focusCursorForView = () => {
        if (!AUTO_FLOW || demoPaused) return;
        let selector = null;
        if (currentView === "connect") selector = '[data-action="connect"]';
        if (currentView === "login") selector = '[data-action="login-continue"]';
        if (currentView === "home") selector = '[data-action="go-new"]';
        if (currentView === "new") selector = '[data-action="create-project"]';
        if (currentView === "work") {
          selector = workMode === "planner" ? "#demoPlannerInput" : "#demoComposerInput";
        }
        if (currentView === "complete") selector = '[data-action="final-cta"]';
        if (!selector) return;
        const scope = currentView === "work" ? demoWorkFlow : demoStartFlow;
        if (!scope) return;
        const target = scope.querySelector(selector);
        if (target) {
          setTimeout(() => {
            moveCursorTo(target);
            clickCursor();
          }, 200);
        }
      };

      const renderFooter = () => {
        const footer = document.createElement("div");
        footer.className = "row demo-footer";
        return footer;
      };

      const showStartFlow = () => {
        if (demoApp) {
          demoApp.classList.remove("chat-app");
        }
        if (demoStartFlow) {
          demoStartFlow.classList.remove("is-hidden");
        }
        if (demoWorkFlow) {
          demoWorkFlow.classList.remove("is-active");
          demoWorkFlow.classList.add("demo-hidden");
        }
      };

      const showWorkFlow = () => {
        if (demoApp) {
          demoApp.classList.add("chat-app");
        }
        if (demoStartFlow) {
          demoStartFlow.classList.add("is-hidden");
        }
        if (demoWorkFlow) {
          demoWorkFlow.classList.remove("demo-hidden");
          demoWorkFlow.classList.add("is-active");
        }
      };

      const scrollMessagesToBottom = () => {
        if (!demoMessagesInner) return;
        scrollIntoViewSafe(demoMessagesInner, { block: "end", behavior: "smooth" });
      };

      const scrollPlannerMessagesToBottom = () => {
        if (!demoPlannerMessagesInner) return;
        scrollIntoViewSafe(demoPlannerMessagesInner, { block: "end", behavior: "smooth" });
      };

      const appendMessageTo = (container, role, text, options = {}) => {
        if (!container) return;
        if (role === "user") {
          container.querySelectorAll(".workingIndicator").forEach((node) => node.remove());
        }
        const wrapper = document.createElement("div");
        wrapper.className = `msg ${role}`;
        if (role === "assistant") {
          const avatar = document.createElement("div");
          avatar.className = "avatar";
          avatar.textContent = "C";
          wrapper.appendChild(avatar);
        }
        const bubble = document.createElement("div");
        bubble.className = "bubble";
        if (text) {
          const span = document.createElement("span");
          span.className = "messageBlock";
          span.textContent = text;
          bubble.appendChild(span);
        }
        if (options.working) {
          const working = document.createElement("div");
          working.className = "workingIndicator";
          working.innerHTML = "<span class=\"spinner\" aria-hidden=\"true\"></span><span>作業中…</span>";
          bubble.appendChild(working);
        }
        if (options.builderComplete) {
          const card = document.createElement("div");
          card.className = "builderCompleteCard";
          const title = document.createElement("div");
          title.className = "title";
          title.textContent = "作業が完了しました";
          const desc = document.createElement("div");
          desc.className = "desc";
          desc.textContent = "できたことと次の操作をまとめました。上の「起動（プレビュー）」で確認できます。";
          const summary = document.createElement("div");
          summary.className = "builderCompleteSummary";
          const rowTasks = document.createElement("div");
          rowTasks.className = "summaryRow";
          rowTasks.innerHTML = "<span class=\"label\">できたこと</span><span class=\"value\"><ul class=\"summaryList\"><li>一覧画面</li><li>追加フォーム</li><li>完了トグル</li></ul></span>";
          const rowFiles = document.createElement("div");
          rowFiles.className = "summaryRow";
          rowFiles.innerHTML = "<span class=\"label\">作った/更新したファイル</span><span class=\"value\">apps/client/src/App.tsx 他2件</span>";
          const rowVerify = document.createElement("div");
          rowVerify.className = "summaryRow";
          rowVerify.innerHTML = "<span class=\"label\">動作確認</span><span class=\"statusTag ok\">OK</span>";
          summary.appendChild(rowTasks);
          summary.appendChild(rowFiles);
          summary.appendChild(rowVerify);
          const tip = document.createElement("div");
          tip.className = "micro";
          tip.textContent = "迷ったら「起動（プレビュー）」→「動作確認」→「改善相談」の順でOKです。";
          const actions = document.createElement("div");
          actions.className = "actions";
          const verifyBtn = document.createElement("button");
          verifyBtn.className = "btn";
          verifyBtn.type = "button";
          verifyBtn.textContent = "動作確認（かんたん）";
          const consultBtn = document.createElement("button");
          consultBtn.className = "btn ghost";
          consultBtn.type = "button";
          consultBtn.textContent = "改善を相談する";
          actions.appendChild(verifyBtn);
          actions.appendChild(consultBtn);
          card.appendChild(title);
          card.appendChild(desc);
          card.appendChild(summary);
          card.appendChild(tip);
          card.appendChild(actions);
          bubble.appendChild(card);
        }
        if (options.logs) {
          const details = document.createElement("details");
          details.className = "logBlock";
          const summary = document.createElement("summary");
          summary.textContent = "作業ログ（クリックで表示）";
          const pre = document.createElement("pre");
          pre.textContent = options.logs;
          details.appendChild(summary);
          details.appendChild(pre);
          bubble.appendChild(details);
        }
        const meta = document.createElement("div");
        meta.className = "meta";
        meta.textContent = role === "assistant" ? "デモ • いま" : "あなた • いま";
        bubble.appendChild(meta);
        wrapper.appendChild(bubble);
        container.appendChild(wrapper);
      };

      const appendMessage = (role, text, options = {}) => {
        appendMessageTo(demoMessagesInner, role, text, options);
        scrollMessagesToBottom();
      };

      const appendPlannerMessage = (role, text) => {
        appendMessageTo(demoPlannerMessagesInner, role, text, {});
        scrollPlannerMessagesToBottom();
      };

      const openPreview = (withCursor = false) => {
        if (!demoPreviewOverlay || previewOpened) return;
        previewOpened = true;
        clearTimeout(previewCloseTimer);
        clearTimeout(previewOpenTimer);
        const openOverlay = () => {
          if (demoPreviewFrame && !demoPreviewFrame.getAttribute("src")) {
            demoPreviewFrame.setAttribute("src", PREVIEW_URL);
          }
          demoPreviewOverlay.classList.add("open");
          demoPreviewOverlay.setAttribute("aria-hidden", "false");
          document.body.classList.add("demo-preview-open");
          if (AUTO_FLOW && withCursor) {
            previewCloseTimer = setTimeout(() => closePreview(true), 1600);
          }
        };
        if (withCursor && demoLaunchPreviewBtn) {
          moveCursorTo(demoLaunchPreviewBtn);
          previewOpenTimer = setTimeout(() => {
            if (demoPaused) return;
            clickCursor();
            previewOpenTimer = setTimeout(() => {
              if (demoPaused) return;
              openOverlay();
            }, 260);
          }, 640);
          return;
        }
        openOverlay();
      };

      const closePreview = (withCursor = false) => {
        if (!demoPreviewOverlay || !previewOpened) return;
        clearTimeout(previewCloseTimer);
        if (withCursor && demoPreviewClose) {
          moveCursorTo(demoPreviewClose);
          clickCursor();
        }
        demoPreviewOverlay.classList.remove("open");
        demoPreviewOverlay.setAttribute("aria-hidden", "true");
        document.body.classList.remove("demo-preview-open");
        previewOpened = false;
      };

      const appendPlannerSummaryMessage = (container) => {
        const target = container || demoMessagesInner;
        if (!target || plannerSummaryShown) return;
        plannerSummaryShown = true;
        const wrapper = document.createElement("div");
        wrapper.className = "msg assistant";
        const avatar = document.createElement("div");
        avatar.className = "avatar";
        avatar.textContent = "C";
        const bubble = document.createElement("div");
        bubble.className = "bubble";
        const card = document.createElement("div");
        card.className = "plannerCompleteCard";
        const title = document.createElement("div");
        title.className = "title";
        title.textContent = "要件がまとまりました";
        const desc = document.createElement("div");
        desc.className = "desc";
        desc.textContent = "相談内容をまとめました。次は作業に進めます。";
        const summary = document.createElement("div");
        summary.className = "plannerSummary";
        const summaryTitle = document.createElement("div");
        summaryTitle.className = "summaryTitle";
        summaryTitle.textContent = "要件定義のまとめ";
        const summaryBody = document.createElement("div");
        summaryBody.className = "summaryBody";
        summaryBody.textContent =
          "作るもの: タスク管理アプリ（Web）\n完成条件: 入力→出力が1往復 / 主要画面が1つ完成\n必須: 追加・完了・削除\n対象: 自分だけ\nやらない: 課金対応\n制約: 期限1週間 / PCのみ";
        const summaryQuestion = document.createElement("div");
        summaryQuestion.className = "summaryQuestion";
        summaryQuestion.textContent = "この内容で作業に進みますか？";
        summary.appendChild(summaryTitle);
        summary.appendChild(summaryBody);
        summary.appendChild(summaryQuestion);
        const note = document.createElement("div");
        note.className = "note";
        note.textContent = "不安な項目があれば変更できます。";
        const actions = document.createElement("div");
        actions.className = "actions";
        const okBtn = document.createElement("button");
        okBtn.className = "btn primary";
        okBtn.type = "button";
        okBtn.textContent = "この内容で作る";
        okBtn.dataset.action = "planner-accept";
        const changeBtn = document.createElement("button");
        changeBtn.className = "btn ghost";
        changeBtn.type = "button";
        changeBtn.textContent = "変更する";
        changeBtn.dataset.action = "planner-edit";
        actions.appendChild(okBtn);
        actions.appendChild(changeBtn);
        card.appendChild(title);
        card.appendChild(desc);
        card.appendChild(summary);
        card.appendChild(note);
        card.appendChild(actions);
        bubble.appendChild(card);
        const meta = document.createElement("div");
        meta.className = "meta";
        meta.textContent = "デモ • いま";
        bubble.appendChild(meta);
        wrapper.appendChild(avatar);
        wrapper.appendChild(bubble);
        target.appendChild(wrapper);
        if (target === demoPlannerMessagesInner) {
          scrollPlannerMessagesToBottom();
        } else {
          scrollMessagesToBottom();
        }
      };

      const appendPlannerRecommendCard = () => {
        if (!demoPlannerMessagesInner) return;
        const wrapper = document.createElement("div");
        wrapper.className = "msg assistant";
        const avatar = document.createElement("div");
        avatar.className = "avatar";
        avatar.textContent = "C";
        const bubble = document.createElement("div");
        bubble.className = "bubble";
        const hint = document.createElement("div");
        hint.className = "planner-recommend-hint";
        hint.textContent = "迷ったら「のこりは全部おまかせで」を使えます。";
        const guard = document.createElement("div");
        guard.className = "planner-recommend-guard";
        guard.textContent = "未確定の項目があるときだけ表示されます。";
        const actions = clonePlannerQuick();
        if (actions) {
          actions.classList.add("planner-recommend-actions");
        }
        bubble.appendChild(hint);
        bubble.appendChild(guard);
        if (actions) {
          bubble.appendChild(actions);
        }
        const meta = document.createElement("div");
        meta.className = "meta";
        meta.textContent = "デモ • いま";
        bubble.appendChild(meta);
        wrapper.appendChild(avatar);
        wrapper.appendChild(bubble);
        demoPlannerMessagesInner.appendChild(wrapper);
        scrollPlannerMessagesToBottom();
      };

      // preview card handled in appendMessage options

      const setWorkMode = (mode) => {
        workMode = mode;
        if (demoWorkFlow) {
          demoWorkFlow.dataset.mode = mode;
        }
        if (mode === "builder") {
          startChatDemo();
        }
      };

      const triggerZoom = () => {
        document.body.classList.add("demo-zoom");
        clearTimeout(zoomTimer);
        zoomTimer = setTimeout(() => {
          document.body.classList.remove("demo-zoom");
        }, 420);
      };

      const bindWorkActions = () => {
        if (!demoWorkFlow || workActionsBound) return;
        workActionsBound = true;
        demoWorkFlow.addEventListener("click", (event) => {
          const quickBtn = event.target.closest(".plannerQuick .btn");
          if (quickBtn) {
            if (quickBtn.classList.contains("primary")) {
              runPlannerAutofill();
              return;
            }
            if (quickBtn.classList.contains("ghost")) {
              appendPlannerSummaryMessage(demoPlannerMessagesInner);
              return;
            }
          }
          const target = event.target.closest("[data-action]");
          if (!target) return;
          const action = target.dataset.action;
          if (!action || target.disabled || target.dataset.frozen === "true") {
            return;
          }
          if (action === "planner-accept") {
            setTimeout(() => setWorkMode("builder"), 260);
            return;
          }
          if (action === "planner-autofill") {
            runPlannerAutofill();
            return;
          }
          if (action === "open-preview") {
            openPreview();
            return;
          }
          if (action === "close-preview") {
            closePreview();
            return;
          }
        });
      };

      const runPlannerAutofillScene = (done) => {
        const fillBtn =
          demoPlannerPanel?.querySelector(".composer .plannerQuick .btn.primary") ||
          demoPlannerPanel?.querySelector(".plannerQuick .btn.primary");
        if (!AUTO_FLOW || demoPaused || !fillBtn) {
          done();
          return;
        }
        scrollIntoViewSafe(fillBtn, { block: "center", behavior: "smooth" });
        moveCursorTo(fillBtn);
        clearTimeout(plannerAutofillTimer);
        plannerAutofillTimer = setTimeout(() => {
          clickCursor();
          done();
        }, 260);
      };

      const runPlannerAutofill = () => {
        if (demoPaused) return;
        if (plannerAutofillDone) return;
        plannerAutofillDone = true;
        appendPlannerMessage("assistant", "残りの要件をおまかせで埋めました。必要なら直してください。");
        appendPlannerSummaryMessage(demoPlannerMessagesInner);
        startPlannerAuto();
      };

      const startPlannerAuto = () => {
        if (!AUTO_FLOW || demoPaused) return;
        clearTimeout(plannerTimer);
        plannerTimer = setTimeout(() => {
          const target = demoPlannerMessagesInner?.querySelector('[data-action="planner-accept"]');
          if (target) {
            moveCursorTo(target);
            clickCursor();
          }
          plannerTimer = setTimeout(() => {
            setTimeout(() => setWorkMode("builder"), 260);
          }, 400);
        }, 1200);
      };

      const startPlannerDemo = () => {
        if (!demoPlannerMessagesInner || plannerChatStarted) return;
        plannerChatStarted = true;
        plannerChatIndex = 0;
        demoPlannerMessagesInner.innerHTML = "<div class=\"day\">今日</div>";
        if (demoPlannerCard) {
          demoPlannerCard.classList.add("demo-hidden");
        }
        const simulatePlannerTyping = (text, done) => {
          if (!demoPlannerInput) {
            done();
            return;
          }
          clearInterval(typingTimer);
          demoPlannerInput.value = "";
          moveCursorTo(demoPlannerInput);
          const chars = Array.from(text);
          let index = 0;
          typingTimer = setInterval(() => {
            demoPlannerInput.value += chars[index] ?? "";
            index += 1;
            if (index >= chars.length) {
              clearInterval(typingTimer);
              clickCursor();
              done();
            }
          }, 40);
        };
        const runPlannerStep = () => {
          if (demoPaused) return;
          if (plannerChatIndex >= PLANNER_CHAT_STEPS.length) {
            if (demoPlannerCard) {
              demoPlannerCard.classList.remove("demo-hidden");
            }
            scrollPlannerMessagesToBottom();
            setTimeout(() => {
              appendPlannerRecommendCard();
              runPlannerAutofillScene(() => {
                setTimeout(() => {
                  runPlannerAutofill();
                }, 360);
              });
            }, 700);
            return;
          }
          const step = PLANNER_CHAT_STEPS[plannerChatIndex];
          const appendAndNext = () => {
            if (demoPaused) return;
            appendPlannerMessage(step.role, step.text);
            if (step.role === "user" && demoPlannerInput) {
              demoPlannerInput.value = "";
            }
            plannerChatIndex += 1;
            plannerChatTimer = setTimeout(runPlannerStep, step.role === "assistant" ? 800 : 600);
          };
          if (step.role === "user") {
            simulatePlannerTyping(step.text, appendAndNext);
            return;
          }
          appendAndNext();
        };
        plannerChatContinue = runPlannerStep;
        runPlannerStep();
      };

      const startChatDemo = () => {
        if (!demoMessagesInner || chatDemoStarted) return;
        chatDemoStarted = true;
        chatDemoIndex = 0;
        demoMessagesInner.innerHTML = "<div class=\"day\">今日</div>";
        const simulateTyping = (text, done) => {
          if (!demoComposerInput) {
            done();
            return;
          }
          clearInterval(typingTimer);
          demoComposerInput.value = "";
          moveCursorTo(demoComposerInput);
          const chars = Array.from(text);
          let index = 0;
          typingTimer = setInterval(() => {
            demoComposerInput.value += chars[index] ?? "";
            index += 1;
            if (index >= chars.length) {
              clearInterval(typingTimer);
              clickCursor();
              done();
            }
          }, 40);
        };
        const runStep = () => {
          if (demoPaused) return;
          if (chatDemoIndex >= CHAT_STEPS.length) {
            if (AUTO_FLOW) {
              chatDemoTimer = setTimeout(() => setView("complete"), 1400);
            }
            return;
          }
          const step = CHAT_STEPS[chatDemoIndex];
          const appendAndNext = () => {
            if (demoPaused) return;
            appendMessage(step.role, step.text, step);
            if (step.role === "user" && demoComposerInput) {
              demoComposerInput.value = "";
            }
            if (step.builderComplete) {
              setTimeout(() => openPreview(true), 700);
              chatDemoIndex += 1;
              chatDemoTimer = setTimeout(runStep, 2000);
              return;
            }
            chatDemoIndex += 1;
            chatDemoTimer = setTimeout(runStep, 1200);
          };
          if (step.role === "user") {
            simulateTyping(step.text, appendAndNext);
            return;
          }
          chatDemoTimer = setTimeout(appendAndNext, 500);
        };
        chatDemoContinue = runStep;
        runStep();
      };

      const renderStartFlow = () => {
        if (!demoBody) return;
        showStartFlow();
        updateHeader();
        demoBody.innerHTML = viewTemplates[currentView] ? viewTemplates[currentView]() : "";
        demoBody.appendChild(renderFooter());
        bindActions();
        if (currentView === "running") {
          startProgress();
        }
      };

      const renderWorkFlow = () => {
        showWorkFlow();
        plannerSummaryShown = false;
        plannerAutofillDone = false;
        chatDemoStarted = false;
        plannerChatStarted = false;
        previewOpened = false;
        clearTimeout(previewCloseTimer);
        if (demoPreviewOverlay) {
          demoPreviewOverlay.classList.remove("open");
          demoPreviewOverlay.setAttribute("aria-hidden", "true");
        }
        document.body.classList.remove("demo-preview-open");
        clearTimeout(plannerChatTimer);
        setWorkMode("planner");
        bindWorkActions();
        startPlannerDemo();
      };

      const render = () => {
        if (currentView === "work") {
          renderWorkFlow();
          return;
        }
        renderStartFlow();
      };

      const bindActions = () => {
        demoBody.querySelectorAll("[data-action]").forEach((button) => {
          button.addEventListener("click", (event) => {
            const target = event.currentTarget;
            const action = target.dataset.action;
            if (!action) return;
            if (target.disabled || target.dataset.frozen === "true") {
              return;
            }
            handleAction(action);
          });
        });
      };

      const scheduleAutoStep = () => {
        if (!AUTO_FLOW || !autoFlowActive || demoPaused) return;
        const step = AUTO_FLOW_STEPS[autoFlowIndex];
        if (!step) return;
        setView(step.view);
        autoFlowIndex += 1;
        if (step.view === "work") {
          return;
        }
        clearTimeout(autoFlowTimer);
        autoFlowTimer = setTimeout(scheduleAutoStep, step.delay);
      };

      const startAutoFlow = () => {
        if (!AUTO_FLOW) return;
        autoFlowActive = true;
        autoFlowIndex = 0;
        ensureDemoStarted();
        scheduleAutoStep();
      };

      const handleAction = (action) => {
        switch (action) {
          case "connect":
            ensureDemoStarted();
            updateConnectionStatus("connecting");
            setTimeout(() => {
              updateConnectionStatus("connected");
              setView("login");
            }, 800);
            break;
          case "login-continue":
          case "login-refresh":
            ensureDemoStarted();
            setView("home");
            break;
          case "go-home":
            setView("home");
            break;
          case "go-new":
            ensureDemoStarted();
            setView("new");
            break;
          case "go-continue":
            ensureDemoStarted();
            setView("continue");
            break;
          case "open-project":
            ensureDemoStarted();
            setView("work");
            break;
          case "open-folder":
            track("cta_click", { target: "folder" });
            alert("デモでは実際のフォルダは開きません。\nC:\\Users\\user\\IchimeAI Demo Projects");
            break;
          case "create-project":
            ensureDemoStarted();
            setView("work");
            break;
          case "complete":
            setView("complete");
            break;
          case "final-cta":
            track("cta_click", { target: "start" });
            window.location.href = START_URL;
            break;
          case "menu-login":
            setView("login");
            toggleMenu(false);
            break;
          case "menu-connect":
            setView("connect");
            toggleMenu(false);
            break;
          case "menu-settings":
            setView("settings");
            toggleMenu(false);
            break;
          default:
            break;
        }
      };

      const startProgress = (resume = false) => {
        const bar = document.getElementById("demoProgressBar");
        const label = document.getElementById("demoProgressLabel");
        const log = document.getElementById("demoLog");
        const logLines = [
          "テンプレを展開中...",
          "セクションを生成中...",
          "色と余白を調整中...",
          "プレビューを準備中...",
        ];
        if (progressTimer) {
          clearInterval(progressTimer);
        }
        if (!resume) {
          progressValue = 0;
        }
        let logIndex = resume
          ? Math.min(Math.floor(progressValue / 30), logLines.length - 1)
          : 0;
        if (log) {
          log.textContent = logLines.slice(0, logIndex + 1).join("\n");
        }
        progressTimer = setInterval(() => {
          progressValue += 10;
          if (progressValue > 100) progressValue = 100;
          if (bar) {
            bar.style.width = `${progressValue}%`;
          }
          if (label) {
            label.textContent = `進捗 ${progressValue}%`;
          }
          if (progressValue >= 30 && logIndex < logLines.length - 1) {
            logIndex += 1;
            if (log) {
              log.textContent += `
${logLines[logIndex]}`;
            }
          }
          if (progressValue >= 100) {
            clearInterval(progressTimer);
            progressTimer = null;
            setTimeout(() => setView("preview"), 800);
          }
        }, 1100);
      };

      const toggleMenu = (open) => {
        const isCurrentlyOpen = !demoMenu.classList.contains("demo-hidden");
        const shouldOpen = open === undefined ? !isCurrentlyOpen : open;
        if (shouldOpen) {
          demoMenu.classList.remove("demo-hidden");
          demoMenuButton.setAttribute("aria-expanded", "true");
        } else {
          demoMenu.classList.add("demo-hidden");
          demoMenuButton.setAttribute("aria-expanded", "false");
        }
      };

      const copyLog = async () => {
        const raw = localStorage.getItem(storageKeys.events) || "[]";
        try {
          await navigator.clipboard.writeText(raw);
          alert("進捗ログをコピーしました。");
        } catch {
          alert("コピーに失敗しました。手動でコンソールから取得してください。");
        }
      };

      const isAllowedInteraction = (target) => {
        if (!(target instanceof Element)) return false;
        if (target.closest(".demo-cta")) return true;
        if (target.closest('[data-action="final-cta"]')) return true;
        return false;
      };

      const handleLockedInteraction = (event) => {
        if (!document.body.classList.contains("demo-locked")) return;
        if (isAllowedInteraction(event.target)) return;
        event.preventDefault();
        event.stopPropagation();
      };

      document.addEventListener("pointerdown", handleLockedInteraction, true);
      document.addEventListener("click", handleLockedInteraction, true);
      document.addEventListener("click", (event) => {
        const target = event.target.closest("button, a, [data-action]");
        if (!target) return;
        const label = (target.textContent || "").replace(/\s+/g, " ").trim().slice(0, 80);
        const action = target.getAttribute("data-action") || "";
        const href = target.tagName === "A" ? (target.getAttribute("href") || "") : "";
        track("demo_ui_click", {
          label,
          action,
          href,
          tag: target.tagName.toLowerCase(),
        });
      });

      demoMenuButton.addEventListener("click", () => toggleMenu());
      document.addEventListener("click", (event) => {
        if (!demoMenu.contains(event.target) && !demoMenuButton.contains(event.target)) {
          demoMenu.classList.add("demo-hidden");
          demoMenuButton.setAttribute("aria-expanded", "false");
        }
      });

      document.body.classList.add("demo-locked");
      track("demo_view");
      updateConnectionStatus("connected");
      updateDemoControls();
      const pauseBtn = document.getElementById("demoPauseBtn");
      const resumeBtn = document.getElementById("demoResumeBtn");
      if (pauseBtn) pauseBtn.addEventListener("click", pauseDemo);
      if (resumeBtn) resumeBtn.addEventListener("click", resumeDemo);
      if (AUTO_FLOW) {
        startAutoFlow();
      } else {
        setView("login");
      }
    </script>
  </body>
</html>
